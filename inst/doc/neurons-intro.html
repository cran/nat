<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Preface</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h2>Preface</h2>

<p>This vignette is designed to give you a good introduction to some of the key
features of nat by teaching you about how it handles individual neurons and 
collections of neurons.</p>

<p>The source code for this vignette is available at 
<a href="https://github.com/jefferis/nat/blob/master/vignettes/neurons-intro.Rmd">https://github.com/jefferis/nat/blob/master/vignettes/neurons-intro.Rmd</a>. 
If you find something unclear or notice a typo, I would be very happy if you 
would click on the Pencil Icon on that page or follow 
<a href="https://github.com/jefferis/nat/edit/master/vignettes/neurons-intro.Rmd">this link to edit</a>
and suggest an alternative wording. Don&#39;t be shy about doing this; I have to 
review any change and even if your suggestion is not perfect it will still
be a prompt for me to improve this document. Thank you!</p>

<h2>Startup</h2>

<p>Install the package if required</p>

<pre><code class="r">install.packages(&#39;nat&#39;, dependencies = TRUE)
</code></pre>

<p>Load the package</p>

<pre><code class="r">library(nat)
</code></pre>

<h2>Neurons and Neuronlists</h2>

<p>There are a number of basic built in types of data in R such as vectors and matrices, 
but it is also very easy to define new data types with specialised features to 
enable powerful and efficient analysis of particular kinds of data. These specialised
data types are called <em>classes</em> and a specific instance of a class is an <em>object</em> 
(a neuroscience analogy: this is the difference between talking about the
general class of mitral cells and the specific cell that you just sealed onto
with your patch clamp electrode.)</p>

<p>We will look at two key classes that <strong>nat</strong> defines for handling 3D structures of neurons</p>

<ul>
<li><code>neuron</code></li>
<li><code>neuronlist</code></li>
</ul>

<h3>Sample Data</h3>

<p>As an example we&#39;re going to look at a data set of olfactory projection neurons originally 
published as Supplemental Information to accompany 
<a href="http://dx.doi.org/10.1016/j.cell.2007.01.040">Jefferis, Potter et al, Cell (2007)</a>.
A subset of the original data are distributed as a sample data object with the
<strong>nat</strong> package, which we can load like so.</p>

<pre><code class="r">data(&quot;Cell07PNs&quot;)
</code></pre>

<p>For more information about these data see <a href="http://jefferis.github.io/nat/reference/Cell07PNs.html">Cell07PNs</a>.</p>

<p>This <code>Cell07PNs</code> object has two classes <code>neuronlist</code> and the base class <code>list</code></p>

<pre><code class="r">class(Cell07PNs)
</code></pre>

<pre><code>## [1] &quot;neuronlist&quot; &quot;list&quot;
</code></pre>

<p>Many R objects inherit from the base class <code>list</code> (objects can have multiple 
classes in the same way that a mitral cell is also neuron) because this is a
convenient container class into which you can put a variety of different kinds 
of data. In this case the <code>Cell07PNs</code> <code>neuronlist</code> contains 40 objects:</p>

<pre><code class="r">length(Cell07PNs)
</code></pre>

<pre><code>## [1] 40
</code></pre>

<pre><code class="r"># access the first neuron in the neuronlist
class(Cell07PNs[[1]])
</code></pre>

<pre><code>## [1] &quot;neuron&quot; &quot;list&quot;
</code></pre>

<p>each representing a traced neuron. We will now look in detail at these two classes.</p>

<h2>Neurons</h2>

<p>We start by extracting the first neuron in Cell07PNs, and assigning it to
a variable. We can then plot the neuron so that we have an image of what we are
talking about.</p>

<pre><code class="r">n1=Cell07PNs[[1]]
plot(n1)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-6"/></p>

<h3>Neuron internal structure</h3>

<p>The <code>str</code> function (short for structure) allows us to take a look at the internal
structure of this neuron object.</p>

<pre><code class="r"># Use =1 so that we don&#39;t show complete structure
# for objects inside n1
str(n1, max.level=1)
</code></pre>

<pre><code>## List of 24
##  $ CellType     : chr &quot;DA1&quot;
##  $ NeuronName   : chr &quot;EBH11R&quot;
##  $ InputFileName:Class &#39;AsIs&#39;  chr &quot;/GD/projects/PN2/TransformedTraces/DA1/EBH11R.tasc&quot;
##  $ CreatedAt    : POSIXt[1:1], format: &quot;2006-01-17 15:21:14&quot;
##  $ NodeName     : Named chr &quot;jefferis.joh.cam.ac.uk&quot;
##   ..- attr(*, &quot;names&quot;)= chr &quot;nodename&quot;
##  $ InputFileStat:&#39;data.frame&#39;:   1 obs. of  10 variables:
##  $ InputFileMD5 : Named chr &quot;fcacee3f874cbe2c6ad96214e6fee337&quot;
##   ..- attr(*, &quot;names&quot;)=Class &#39;AsIs&#39;  chr &quot;/GD/projects/PN2/TransformedTraces/DA1/EBH11R.tasc&quot;
##  $ NumPoints    : int 180
##  $ StartPoint   : num 1
##  $ BranchPoints : num [1:16] 34 48 51 75 78 95 98 99 108 109 ...
##  $ EndPoints    : num [1:18] 1 42 59 62 80 85 96 100 102 112 ...
##  $ NumSegs      : int 33
##  $ SegList      :List of 33
##  $ d            :&#39;data.frame&#39;:   180 obs. of  7 variables:
##  $ OrientInfo   :List of 5
##  $ SegOrders    : num [1:33] 1 2 2 3 4 4 3 4 5 5 ...
##  $ MBPoints     : int [1:2] 34 48
##  $ LHBranchPoint: int 75
##  $ SegTypes     : num [1:33] 1 3 1 3 3 3 1 2 2 2 ...
##  $ AxonSegNos   :List of 3
##  $ LHSegNos     : num [1:26] 8 9 10 11 12 13 14 15 16 17 ...
##  $ MBSegNos     :List of 2
##  $ NumMBBranches: num 2
##  $ AxonLHEP     : num 72
##  - attr(*, &quot;class&quot;)= chr [1:2] &quot;neuron&quot; &quot;list&quot;
</code></pre>

<p>From this you can see that there are a large number of fields inside the neuron.
Each field can be accessed using the <code>$</code> or <code>[[</code> operators</p>

<pre><code class="r">n1$NumPoints
</code></pre>

<pre><code>## [1] 180
</code></pre>

<pre><code class="r">n1[[&quot;NumPoints&quot;]]
</code></pre>

<pre><code>## [1] 180
</code></pre>

<p>There are a set of core fields (described in <code>?neuron</code> documentation); the key 
ones will be described shortly. However there are also quite a few user fields
in this neuron and you can safely add any field you like so long as its name 
does not clash with an existing field. For example:</p>

<pre><code class="r">n1$Comment=&#39;The sex of this specimen is uncertain&#39;
</code></pre>

<p>The single most important field in a neuron is the <code>$d</code> <code>data.frame</code>. This 
contains a block of data closely reminiscent of the SWC data format for traced 
neurons:</p>

<pre><code class="r">str(n1$d)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    180 obs. of  7 variables:
##  $ PointNo: int  1 2 3 4 5 6 7 8 9 10 ...
##  $ Label  : num  2 2 2 2 2 2 2 2 2 2 ...
##  $ X      : num  187 187 188 188 188 ...
##  $ Y      : num  133 131 130 129 129 ...
##  $ Z      : num  88.2 90.6 93.1 95 97.5 ...
##  $ W      : num  1.01 1.27 1.14 1.27 1.27 1.27 1.27 1.27 1.27 1.27 ...
##  $ Parent : num  -1 1 2 3 4 5 6 7 8 9 ...
</code></pre>

<p>Each row defines a node in a branched tree with a unique integer identifier,
<code>PointNo</code>, normally but not always sequentially numbered from 1. The <code>X,Y,Z</code> 
columns encode the position of each vertex and the <code>W</code> column encodes the 
diameter of the neurite at that position.</p>

<h3>Methods for neurons</h3>

<p>R&#39;s simple <a href="http://adv-r.had.co.nz/OO-essentials.html">S3 object oriented system</a>
allows specialised functions for particular classes to be defined. These functions
tailored to a particular class are called <em>methods</em>. Methods can be provided for
pre-existing functions supplied with base R as well as new user-written functions.
The system is quite simple. If a function <code>foo</code> is defined as a <em>generic</em> function
then you can define new functions called <code>foo.bar</code> that will be called when
you write <code>foo(x)</code> and <code>x</code> has class bar.</p>

<p>We already used one such method without comment, <code>plot.neuron</code>. There is a base
R function called <code>plot</code>. nat defines a new function called <code>plot.neuron</code>, which
R interprets as a <code>plot</code> method specialised for <code>neuron</code> objects. When the base
R <code>plot</code> function is called, it looks at the class of its first object to see
whether a specialised method exists. If there is none, it will use a fallback
method called <code>plot.default</code>.</p>

<p>The <code>plot.neuron</code> method interprets the branching structure of a neuron and
draws line segments joining up the connected nodes at the appropriate 2D positions.
You can compare it with what you would get if you just plotted the XY position 
of all nodes joined together by a single line:</p>

<pre><code class="r">plot(n1$d$X, n1$d$Y, type = &#39;l&#39;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-11"/></p>

<p>You can find out what methods are available for a particular class like so:</p>

<pre><code class="r">methods(class = &#39;neuron&#39;)
</code></pre>

<pre><code>##  [1] *                  +                  -                 
##  [4] /                  all.equal          as.neuron         
##  [7] as.ngraph          as.seglist         boundingbox       
## [10] branchpoints       dotprops           endpoints         
## [13] ndigest            nvertices          plot              
## [16] plot3d             potential_synapses prune             
## [19] resample           rootpoints         scale             
## [22] subset             summary            write.vtk         
## [25] xform              xyzmatrix          xyzmatrix&lt;-       
## see &#39;?methods&#39; for accessing help and source code
</code></pre>

<p>You can then find the help page for any method in the console with <code>?plot.neuron</code>. 
Note that if you write <code>?plot</code> you will get the documentation for the basic 
<code>plot</code> function supplied with R.</p>

<p>It is also good idea to look at 
<a href="http://jefferis.github.io/nat/reference/index.html">nat&#39;s function reference page</a>
which groups available functions into categories that often reflect the class
of object they can work on.</p>

<p>In R, operators such as <code>*</code> or <code>+</code> are actually special functions with two 
arguments, so one can add methods for these in the same way. In the following
example we use this arithmetic to shift a neuron by a small amount:</p>

<pre><code class="r">plot(n1, col = &#39;black&#39;, WithNodes = F, main=&quot;Shifting neurons&quot;)
# shift by 3 microns in x,y,z
plot(n1+3, col = &#39;red&#39;, add = TRUE, WithNodes = F)
# shift by -5 microns in y
plot(n1+c(0,-5,0), col = &#39;blue&#39;, add = TRUE, WithNodes = F)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-13"/></p>

<p>Another specialised method is <code>subset.neuron</code> which we can use to extract part
of a neuron into a new object. For example, a simple spatial criterion, 
X location must be &gt;240, is used to extract the axon terminal arborisation field
in this example</p>

<pre><code class="r">plot(n1, col = &#39;black&#39;, WithAllPoints = T, main=&quot;Subsetting a neuron&quot;)
# keep only nodes with X position &gt;20
n1.lh=subset(n1, X&gt;240)
# plot the selected part of the neuron in blue
plot(n1.lh, col=&#39;blue&#39;, lwd=3, add=TRUE)
# add a line illustrating the cut point
abline(v=240, lty=2)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-14"/></p>

<p>We can also summarise the morphological properties of a neuron using the
<code>summary.neuron</code> method, which allows us to compare measurements for the original
neuron and the axon arbour that we just cut out above.</p>

<pre><code class="r">summary(n1)
</code></pre>

<pre><code>##   root nodes segments branchpoints endpoints cable.length
## 1    1   180       33           16        18     297.1763
</code></pre>

<pre><code class="r">summary(n1.lh)
</code></pre>

<pre><code>##   root nodes segments branchpoints endpoints cable.length
## 1    1   111       27           13        15     156.7654
</code></pre>

<p>See <a href="http://jefferis.github.io/nat/reference/index.html">nat&#39;s function reference page</a>
for additional functions for working with neurons.</p>

<h2>Neuronlists</h2>

<p>The <code>data</code> statement above loaded a <code>neuronlist</code> object called <code>Cell07PNs</code> 
containing 40 <code>neuron</code> objects. <code>neuronlist</code> objects are key 
data structures in nat for convenient handling of collections of neurons.</p>

<p><img src="data:image/png;base64,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" alt="Structure of neuronlist objects"/></p>

<p>The diagram above presents the structure of a neuronlist, <code>x</code>, which contains
5 neurons. The main structure is an R <code>list</code> object, which in this case contains
5 slots. Each slot contains a neuron with a unique name. In addition to this 
list of neurons there is an optional attached <code>data.frame</code> (another standard R class).
When present, each neuron in the main list must have a matching row in this <code>data.frame</code>.</p>

<p>Neuronlists can be manipulated use the square bracket subscript operator to 
extract or replace a subset of their elements. Crucially when this happens the
corresponding rows of the attached metadata are also selected as diagrammed for 
the result of x<a href="right%20hand%20side%20of%20figure%20above">1:3</a>.</p>

<p>When subscripting any list in R, it is very important to understand the difference 
between using the single and double bracket operator. We can illustrate this
difference as follows:</p>

<p><img src="data:image/png;base64,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" alt="The difference between single and double bracket subscript operators"/></p>

<p>The single bracket operator makes a new list containing a specified subset of
elements in the original list, while the double bracket operator extracts the
object at the given position. So in the figure <code>x[1]</code> is a <code>neuronlist</code> object
of length 1, whereas <code>x[[1]]</code> is the <code>neuron</code> object at the first position in 
the list.</p>

<h3>Worked Examples</h3>

<p>Let us start by extracting the first five neurons from our sample data.</p>

<pre><code class="r"># we can select neurons by indexing 
first5=Cell07PNs[1:5]
summary(first5)
</code></pre>

<pre><code>##        root nodes segments branchpoints endpoints cable.length
## EBH11R    1   180       33           16        18     297.1763
## EBH20L    1   200       26           12        15     327.0929
## EBH20R    1   199       25           12        14     347.6153
## EBI12L    1   169       23           11        13     294.4680
## EBI22R    1   160       27           13        15     303.0150
</code></pre>

<p>Each neuron in the neuronlist has an associated name which can be used to select
it. We can get the names of all neurons using the <code>names</code> function.</p>

<pre><code class="r">names(Cell07PNs)
</code></pre>

<pre><code>##  [1] &quot;EBH11R&quot; &quot;EBH20L&quot; &quot;EBH20R&quot; &quot;EBI12L&quot; &quot;EBI22R&quot; &quot;EBJ23L&quot; &quot;EBJ3R&quot; 
##  [8] &quot;EBN19L&quot; &quot;EBO15L&quot; &quot;EBO53L&quot; &quot;ECA34L&quot; &quot;ECB3L&quot;  &quot;LI23L&quot;  &quot;LIC2R&quot; 
## [15] &quot;LJ5L&quot;   &quot;MC3B&quot;   &quot;MH16L&quot;  &quot;MM14L&quot;  &quot;NA7L&quot;   &quot;NH15L&quot;  &quot;NH29B&quot; 
## [22] &quot;NI16L&quot;  &quot;NIA8L&quot;  &quot;NIA8R&quot;  &quot;NNA9L&quot;  &quot;NNC4R&quot;  &quot;NNE1L&quot;  &quot;OFD2L&quot; 
## [29] &quot;OKC9R&quot;  &quot;SDD8L&quot;  &quot;SH21L&quot;  &quot;SL20L&quot;  &quot;TKC8R&quot;  &quot;TL4R&quot;   &quot;TS7L&quot;  
## [36] &quot;TT27R&quot;  &quot;VA15R&quot;  &quot;VA20R&quot;  &quot;VB37L&quot;  &quot;VB58L&quot;
</code></pre>

<pre><code class="r">nl3=Cell07PNs[c(&quot;EBH11R&quot;, &quot;EBH20L&quot;, &quot;EBH20R&quot;)]
all.equal(nl3, Cell07PNs[1:3])
</code></pre>

<pre><code>## [1] TRUE
</code></pre>

<p>You can also use the <code>$</code> operator to access a single neuron e.g. <code>Cell07PNs$EBH11R</code>.
This can be quite useful when working interactively in the console because 
RStudio will offer to autocomplete the neuron name when you start typing past the
<code>$</code> symbol, but is not recommended for scripts.</p>

<h3>Metadata</h3>

<p>The names of neurons are also used to index a <code>data.frame</code> object attached to the
neuronlist with one row for each neuron. You can use the <code>head</code> function to give 
a summary of the attached metadata in this neuronlist. Using the <code>as.data.frame</code> method on
a neuronlist allows you to extract this attached metadata to a separate object.</p>

<pre><code class="r">head(Cell07PNs)
</code></pre>

<pre><code>##         Brain RegistrationScore Notes Glomerulus Batch Directory Traced
## EBH11R EBH11R                 4              DA1   PN2    unsure    yes
## EBH20L EBH20L                 4              DL3   PN2   unsure2    yes
## EBH20R EBH20R                 4              DA1   PN2   unsure2    yes
## EBI12L EBI12L                 4              DA1   PN2   unsure3    yes
## EBI22R EBI22R                 4              DL3   PN2   unsure3    yes
## EBJ23L EBJ23L                 4              DL3   PN2   unsure4    yes
##        Scored.By Sex Include     ID HaveWarp HaveAsc
## EBH11R       ACH   M         EBH11R     TRUE    TRUE
## EBH20L       ACH             EBH20L     TRUE    TRUE
## EBH20R       ACH   M         EBH20R     TRUE    TRUE
## EBI12L       ACH   F         EBI12L     TRUE    TRUE
## EBI22R       ACH             EBI22R     TRUE    TRUE
## EBJ23L       ACH             EBJ23L     TRUE    TRUE
##                                                 TraceFile AscBatch Status
## EBH11R /GD/projects/PN2/TransformedTraces/DA1/EBH11R.tasc      New       
## EBH20L /GD/projects/PN2/TransformedTraces/DL3/EBH20L.tasc      New       
## EBH20R /GD/projects/PN2/TransformedTraces/DA1/EBH20R.tasc      New       
## EBI12L /GD/projects/PN2/TransformedTraces/DA1/EBI12L.tasc      New       
## EBI22R /GD/projects/PN2/TransformedTraces/DL3/EBI22R.tasc      New       
## EBJ23L /GD/projects/PN2/TransformedTraces/DL3/EBJ23L.tasc      New       
##        GlomSeq NumNAs MBP1 MBP2 LHBP PNType Seq nTrees StartPoint
## EBH11R       1      0   34   48   75    iPN  13      1          1
## EBH20L       1      0   29   29   77    iPN  15      1          1
## EBH20R       2      0   24   80  147    iPN  16      1          1
## EBI12L       3      0   29   59   89    iPN  18      1          1
## EBI22R       2      0   34   34   56    iPN  20      1          1
## EBJ23L       3      0   23   23   52    iPN  21      1          1
##                  CreatedAt
## EBH11R 2006-01-17 15:21:14
## EBH20L 2006-01-17 15:21:14
## EBH20R 2006-01-17 15:21:14
## EBI12L 2006-01-17 15:21:15
## EBI22R 2006-01-17 15:21:15
## EBJ23L 2006-01-17 15:21:15
##                                                                                             WarpFile
## EBH11R  /GD/projects/PN2/allreg/warp/unsure/average-goodbrains_EBH11R101_warp_m0g40c4e1e-1x16r3.list
## EBH20L /GD/projects/PN2/allreg/warp/unsure2/average-goodbrains_EBH20L101_warp_m0g40c4e1e-1x16r3.list
## EBH20R /GD/projects/PN2/allreg/warp/unsure2/average-goodbrains_EBH20R101_warp_m0g40c4e1e-1x16r3.list
## EBI12L /GD/projects/PN2/allreg/warp/unsure3/average-goodbrains_EBI12L101_warp_m0g40c4e1e-1x16r3.list
## EBI22R /GD/projects/PN2/allreg/warp/unsure3/average-goodbrains_EBI22R101_warp_m0g40c4e1e-1x16r3.list
## EBJ23L /GD/projects/PN2/allreg/warp/unsure4/average-goodbrains_EBJ23L101_warp_m0g40c4e1e-1x16r3.list
</code></pre>

<pre><code class="r">df=as.data.frame(Cell07PNs)
nrow(df)
</code></pre>

<pre><code>## [1] 40
</code></pre>

<pre><code class="r"># rownames of data.frame are the same as names of Cell07PNs list.
all.equal(rownames(df), names(Cell07PNs))
</code></pre>

<pre><code>## [1] TRUE
</code></pre>

<p>You can use columns in the attached metadata in expressions that select or 
operate on the neurons in the list. In the next two examples we </p>

<ul>
<li><code>subset</code> the neurons in a neuronlist based on a metadata column</li>
<li>use the <code>with</code> function to carry out a calculation using column(s)
of metadata.</li>
</ul>

<pre><code class="r"># subset.neuronlist method (which you call using the subset function)
da1n=subset(Cell07PNs, Glomerulus==&quot;DA1&quot;)

# with.neuronlist method
with(Cell07PNs, table(Glomerulus))
</code></pre>

<pre><code>## Glomerulus
##  DA1  DL3 DP1m VA1d 
##   11   10    8   11
</code></pre>

<p>There is a second approach to accessing this attached metadata data.frame, using
the square bracket operator with two arguments as used for subscripting (2D) 
matrices or <code>data.frames</code>. For example we can access the <code>Glomerulus</code> column
like so:</p>

<pre><code class="r">Cell07PNs[, &#39;Glomerulus&#39;]
</code></pre>

<pre><code>##  [1] DA1  DL3  DA1  DA1  DL3  DL3  VA1d VA1d VA1d VA1d DP1m DP1m DA1  DL3 
## [15] VA1d VA1d DL3  DA1  DA1  VA1d VA1d VA1d DL3  VA1d DP1m DP1m DP1m DP1m
## [29] DP1m DP1m DA1  DL3  DL3  DL3  VA1d DA1  DA1  DA1  DL3  DA1 
## Levels: DA1 DL3 DP1m VA1d
</code></pre>

<p>This approach has some features that make for additional flexibility. For example
you can acess the whole data.frame like so:</p>

<pre><code class="r">summary(Cell07PNs[,])
</code></pre>

<p>The form <code>[,]</code> which includes a comma implies two (missing) arguments. 
<strong>nat</strong> therefore interprets this as request for the 2D data.frame
attached to Cell07PNs rather than the neuronlist itself. You can also use this 
notation to add new columns or modify existing columns in place.</p>

<pre><code class="r">Cell07PNs[, &#39;NewColumn&#39;] = somevariable
Cell07PNs[, &quot;Sex&quot;] = sub(&quot;F&quot;, &quot;female&quot;, Cell07PNs[, &quot;Sex&quot;])
Cell07PNs[, &quot;Sex&quot;] = sub(&quot;M&quot;, &quot;male&quot;, Cell07PNs[, &quot;Sex&quot;])
</code></pre>

<p>You can also access selected rows of the data.frame in the normal way:</p>

<pre><code class="r">Cell07PNs[1:5, &quot;Glomerulus&quot;]
Cell07PNs[Cell07PNs[, &quot;Sex&quot;]==&quot;F&quot;, &quot;Glomerulus&quot;]
</code></pre>

<h3>Working on all the neurons in a neuronlist</h3>

<p>There are quite a few methods defined for the <code>neuronlist</code> class:</p>

<pre><code class="r">methods(class = &quot;neuronlist&quot;)
</code></pre>

<pre><code>##  [1] *                  +                  -                 
##  [4] /                  [                  [&lt;-               
##  [7] as.data.frame      as.neuronlistfh    c                 
## [10] data.frame&lt;-       dimnames           dotprops          
## [13] droplevels         head               intersect         
## [16] mirror             nvertices          plot              
## [19] plot3d             potential_synapses prune             
## [22] setdiff            subset             summary           
## [25] tail               union              with              
## [28] xform              xyzmatrix          xyzmatrix&lt;-       
## see &#39;?methods&#39; for accessing help and source code
</code></pre>

<p>For example we can scale the position (and diameter) of all of the neurons in a
neuronlist using the <code>*</code> operator:</p>

<pre><code class="r"># convert from microns to nm
Cell07PNs.nm = Cell07PNs*1e3
plot(Cell07PNs.nm)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-25"/></p>

<p>There is also a more powerful <code>xform</code> function that allows arbitrary 
transformations to be applied. For example here we apply a 3D rotation expressed
as a homogeneous affine matrix:</p>

<pre><code class="r"># define a 180 degree rotation around the x axis
rotm=cmtkparams2affmat(rx=180)
# remove tiny values due to rounding errors
rotm=zapsmall(rotm)
plot(xform(Cell07PNs, rotm))
</code></pre>

<p><img src="data:image/png;base64,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FudB7pB1rCjuqucz/OPvuxif2FkdGMtwy70hRLjNFSR5dFWZo6c1diVxQennLoARpaCvxLbajnVLJE3IULcgkchj30fOUw+41xSgLYMOJd5yboeNP8KzuHEFXaq84jZX4mnbJNWJ/dwbh4I6j21itGzPHUlDvhR6Er+RnKcoOD7rC6MrqXr0bbrq4ieUMZeD4/IIOE/xwjguZjb6lEE7HkJxs5rQl2MRLnaqKui7hLSBc7WFuQdzj+PkDsrhYm1+NSmBPTxmI86yncdhWW0Mb1f8rcl87m+qwH2aY6KXj//HWV8udtNxy4noZdjRoXnAkC0ovVEaKeg5zUchZinirKM4k4AnRjJuvnhQ7FWKQmhjplhuZj8KeiOcg4K+W1wBwgMyX3oIorrwiPtYg8cfF2DzoDQlDnHdeREyBX2f+OpjGafRPjoG3+HHSFyc9B57UpEOMuaA0zhv3ZSCvkd8Hb1YrkRhWBCNIp894coObEwrS2IdjoC+4/fPFPTduuo1zQ1PWcz9fH9pXv3J3wH8OTHxx24oYdMAAAUsSURBVAduk4K+XfG63hjT5vI7rc6jwWxepBhcKxLpnCoZ7oqOFxe8+zKRCvpWAWucoxhTidRUZQp39VcXXUP5GGcuccmtoFdWSS4+jLmeKesUjuz4AyWMOufE42rZO6Sgb9cisnhBCOKJsZTUxHMBZlZ9W9p8Qwp6KUWUjnuQZs2hn/nLElLQK4hPzoiDVLEovDlidacU9AoqezLaEXRSnlmw3LoKehWVPRmh/NEu1OCJgv62Mqbq7FhueQW9gczirK97paA30Qo/zKCghaSghaSghaSghaSghaSghaSghaSghaSghaSghaSghaSghaSghaSghaSghaSghaSghaSghaSghaSghaSghaSghaSghaSghaSghaSghaSghaSghaSghaSghaSghaSghaSghaSghaSghaSghaSghaSghaSghaSghaSghaSghaSghbQx6E8/70F/+WONdXdJm4L++voV33/48c+V190pbQr6y9/+WLhfZd2dkka0kDb26C+/qkcvI806hKSghfQYjSHc46ZFK+gFPQJoTjg+/cfVOpU2/nDfkx4B9Kdf/tT07kFtDPrXH/7534joXzS9u1ebN4ZfX+/9FD5oeveANOsQkoIW0uOAfvty/XV3RApaSApaSOrRQlLQQlLQQlLQQlLQQlLQQlLQQlLQQlLQQlLQQlLQQlLQQlLQQlLQQlLQQlLQQlLQQlLQQlLQQlLQQlLQQlLQQlLQQlLQQlLQQlLQQlLQQlLQQlLQQlLQQlLQQlLQQlLQQlLQQlLQQlLQQlLQQlLQQlLQQlLQQlLQQlLQQlLQQlLQQlLQQlLQQlLQQlLQQlLQQlLQQlLQQlLQQlLQQvqWoFXz+nagN9vg8u/8DZb8Fm8us53VN6ighTaooIU2qKCFNqighTaooIU2qKBV30IKWkgKWkgKWkgKWkgKWkgKWkgKWkgKWkgKWkiPBvrTv/7BvyGOHy/78uttvzMZF/t5b+/VbIl7FqyWXFzhviXLHyJ++M2/vt774bdl3/yB/VlajwX6Az7Rl7/+Ft7++Cf29+1Pty6GJT79y2/lEvcsWC25uMJ9S9KjtwTn4TcPv7/Cb0Iv+eb378/yeiTQv//wvxTR+M3D8hc9OcBv6gM+7++vyiXuWbBacnGF+5ak+Pv3/3wVlnvzEO5bsFry4f1ZXo9qHWUE8Of76293LUkvlUs8sGD12pJLfv3HPyn0lnnz/4F1LLHJ5fZnOT2uR0czw2+13/3Bvr5+WS1x/4K85OIK9y759iWO8Yff/NPP/HUss8ll9mdJPSpoGOCHv/xxbwR8+fVlCEtFNC+5uMJ9S9IiXx+K6BXffJn9WVaPCrr86u/zNITTzB/vNb+45OIK9y35lidXvFzizf/+4Kcsl1xif5bWt4hoHHV3tNIlvXKJexZc5LzMkiGmdw+/ORpODv+H3/zB/Vlej+vRH/YeyFBj2L1aIo8ul7y2wn3bfDCPntvWA9lxteSD+7O8tDIUkoIWkoIWkoIWkoIWkoIWkoIWkoIWkoIWkoIWkoIWkoIWkoIWkoIWkoIWkoIWkoIWkoIWkoIWkoIW0paDfotB099fPvXHWEJbDrqcOvDUn2IJbTvoT7/83z82nEMko20HHd7+1zYYx3cA+mqe0vPWtoP++o//3QqL3nrQH37ajqRj20E/ykRPEW036DhV/e3GMxAFtN2gt0gKWkgKWkgKWkgKWkgKWkgKWkgKWkgKWkgKWkgKWkgKWkgKWkgKWkgKWkgKWkgKWkgKWkj/D7p4ikz6TMWuAAAAAElFTkSuQmCC" alt="plot of chunk unnamed-chunk-26"/></p>

<p>More generally any function that works on a neuron can be applied to a 
neuronlist by using the function <code>nlapply</code>. This is an analogue to base R&#39;s
<code>lapply</code> function. This will take care of returning a new neuronlist with the
attached metadata and includes additional features such as error tolerance,
progress bars and parallelisation for multi-core machines. It is worth reviewing
the help and examples for this function carefully if you start to work regularly with 
neuronlists.</p>

<h2>Plots</h2>

<p>We have already seen that we can plot a single neuron (the first) like so:</p>

<pre><code class="r">plot(Cell07PNs[[1]])
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-27"/></p>

<p>The purple node higlights the root or soma of the neuron, red nodes are branch
points, green nodes are end points. We can also label each node with its <code>PointNo</code> index.</p>

<pre><code class="r">plot(Cell07PNs[[1]], col=&#39;red&#39;, WithText=T)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-28"/></p>

<p>Multiple neurons can be plotted by passing a whole neuronlist or indexing it</p>

<pre><code class="r">plot(Cell07PNs[1:3])
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-29"/></p>

<p>More complex subsets are possible by using <code>plot.neuronlist</code> subset argument
(which works in the same way as the <code>subset.neuronlist</code> function). For example
here we select neurons by which olfactory glomeruli their dendrites occupy:</p>

<pre><code class="r">plot(Cell07PNs, subset=Glomerulus!=&quot;DA1&quot;, col=&#39;grey&#39;, WithNodes=F, main=&quot;DA1 neurons&quot;)
plot(Cell07PNs, subset=Glomerulus==&quot;DA1&quot;, add=TRUE)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-30"/></p>

<h3>3D plots</h3>

<p>So far we have only used 2D plots in this document, but especially for 
interactive analysis and exploration, it is much more helpful to have 
3D plots that can be rotated, zoomed etc. <strong>nat</strong> provides numerous functions 
for <a href="http://jefferis.github.io/nat/reference/index.html#section--d-plotting-of-objects">3D plots</a>
based on the <a href="https://cran.r-project.org/package=rgl">rgl package</a>. It is 
actually possible to embed fully interactive 3d figures in <a href="http://rmarkdown.rstudio.com/">rmarkdown</a> reports
like this one by setting the <a href="https://CRAN.R-project.org/package=rgl/vignettes/WebGL.html">webgl chunk option</a>.</p>

<pre><code class="r">clear3d()
plot3d(Cell07PNs[[1]], col=&#39;red&#39;)
# set a grey background so it&#39;s easier to see extent of the webgl canvas
bg3d(col=&#39;lightgrey&#39;)
</code></pre>

<script>/*
* Copyright (C) 2009 Apple Inc. All Rights Reserved.
*
* Redistribution and use in source and binary forms, with or without
* modification, are permitted provided that the following conditions
* are met:
* 1. Redistributions of source code must retain the above copyright
*    notice, this list of conditions and the following disclaimer.
* 2. Redistributions in binary form must reproduce the above copyright
*    notice, this list of conditions and the following disclaimer in the
*    documentation and/or other materials provided with the distribution.
*
* THIS SOFTWARE IS PROVIDED BY APPLE INC. ``AS IS'' AND ANY
* EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
* IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
* PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL APPLE INC. OR
* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
* EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
* PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
* PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
* OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
* (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
* OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
* Copyright (2016) Duncan Murdoch - fixed CanvasMatrix4.ortho,
* cleaned up.
*/
/*
CanvasMatrix4 class
This class implements a 4x4 matrix. It has functions which
duplicate the functionality of the OpenGL matrix stack and
glut functions.
IDL:
[
Constructor(in CanvasMatrix4 matrix),           // copy passed matrix into new CanvasMatrix4
Constructor(in sequence<float> array)           // create new CanvasMatrix4 with 16 floats (row major)
Constructor()                                   // create new CanvasMatrix4 with identity matrix
]
interface CanvasMatrix4 {
attribute float m11;
attribute float m12;
attribute float m13;
attribute float m14;
attribute float m21;
attribute float m22;
attribute float m23;
attribute float m24;
attribute float m31;
attribute float m32;
attribute float m33;
attribute float m34;
attribute float m41;
attribute float m42;
attribute float m43;
attribute float m44;
void load(in CanvasMatrix4 matrix);                 // copy the values from the passed matrix
void load(in sequence<float> array);                // copy 16 floats into the matrix
sequence<float> getAsArray();                       // return the matrix as an array of 16 floats
WebGLFloatArray getAsCanvasFloatArray();           // return the matrix as a WebGLFloatArray with 16 values
void makeIdentity();                                // replace the matrix with identity
void transpose();                                   // replace the matrix with its transpose
void invert();                                      // replace the matrix with its inverse
void translate(in float x, in float y, in float z); // multiply the matrix by passed translation values on the right
void scale(in float x, in float y, in float z);     // multiply the matrix by passed scale values on the right
void rotate(in float angle,                         // multiply the matrix by passed rotation values on the right
in float x, in float y, in float z);    // (angle is in degrees)
void multRight(in CanvasMatrix matrix);             // multiply the matrix by the passed matrix on the right
void multLeft(in CanvasMatrix matrix);              // multiply the matrix by the passed matrix on the left
void ortho(in float left, in float right,           // multiply the matrix by the passed ortho values on the right
in float bottom, in float top,
in float near, in float far);
void frustum(in float left, in float right,         // multiply the matrix by the passed frustum values on the right
in float bottom, in float top,
in float near, in float far);
void perspective(in float fovy, in float aspect,    // multiply the matrix by the passed perspective values on the right
in float zNear, in float zFar);
void lookat(in float eyex, in float eyey, in float eyez,    // multiply the matrix by the passed lookat
in float ctrx, in float ctry, in float ctrz,    // values on the right
in float upx, in float upy, in float upz);
}
*/
CanvasMatrix4 = function(m)
{
if (typeof m == 'object') {
if ("length" in m && m.length >= 16) {
this.load(m[0], m[1], m[2], m[3], m[4], m[5], m[6], m[7], m[8], m[9], m[10], m[11], m[12], m[13], m[14], m[15]);
return;
}
else if (m instanceof CanvasMatrix4) {
this.load(m);
return;
}
}
this.makeIdentity();
};
CanvasMatrix4.prototype.load = function()
{
if (arguments.length == 1 && typeof arguments[0] == 'object') {
var matrix = arguments[0];
if ("length" in matrix && matrix.length == 16) {
this.m11 = matrix[0];
this.m12 = matrix[1];
this.m13 = matrix[2];
this.m14 = matrix[3];
this.m21 = matrix[4];
this.m22 = matrix[5];
this.m23 = matrix[6];
this.m24 = matrix[7];
this.m31 = matrix[8];
this.m32 = matrix[9];
this.m33 = matrix[10];
this.m34 = matrix[11];
this.m41 = matrix[12];
this.m42 = matrix[13];
this.m43 = matrix[14];
this.m44 = matrix[15];
return;
}
if (arguments[0] instanceof CanvasMatrix4) {
this.m11 = matrix.m11;
this.m12 = matrix.m12;
this.m13 = matrix.m13;
this.m14 = matrix.m14;
this.m21 = matrix.m21;
this.m22 = matrix.m22;
this.m23 = matrix.m23;
this.m24 = matrix.m24;
this.m31 = matrix.m31;
this.m32 = matrix.m32;
this.m33 = matrix.m33;
this.m34 = matrix.m34;
this.m41 = matrix.m41;
this.m42 = matrix.m42;
this.m43 = matrix.m43;
this.m44 = matrix.m44;
return;
}
}
this.makeIdentity();
};
CanvasMatrix4.prototype.getAsArray = function()
{
return [
this.m11, this.m12, this.m13, this.m14,
this.m21, this.m22, this.m23, this.m24,
this.m31, this.m32, this.m33, this.m34,
this.m41, this.m42, this.m43, this.m44
];
};
CanvasMatrix4.prototype.getAsWebGLFloatArray = function()
{
return new WebGLFloatArray(this.getAsArray());
};
CanvasMatrix4.prototype.makeIdentity = function()
{
this.m11 = 1;
this.m12 = 0;
this.m13 = 0;
this.m14 = 0;
this.m21 = 0;
this.m22 = 1;
this.m23 = 0;
this.m24 = 0;
this.m31 = 0;
this.m32 = 0;
this.m33 = 1;
this.m34 = 0;
this.m41 = 0;
this.m42 = 0;
this.m43 = 0;
this.m44 = 1;
};
CanvasMatrix4.prototype.transpose = function()
{
var tmp = this.m12;
this.m12 = this.m21;
this.m21 = tmp;
tmp = this.m13;
this.m13 = this.m31;
this.m31 = tmp;
tmp = this.m14;
this.m14 = this.m41;
this.m41 = tmp;
tmp = this.m23;
this.m23 = this.m32;
this.m32 = tmp;
tmp = this.m24;
this.m24 = this.m42;
this.m42 = tmp;
tmp = this.m34;
this.m34 = this.m43;
this.m43 = tmp;
};
CanvasMatrix4.prototype.invert = function()
{
// Calculate the 4x4 determinant
// If the determinant is zero,
// then the inverse matrix is not unique.
var det = this._determinant4x4();
if (Math.abs(det) < 1e-8)
return null;
this._makeAdjoint();
// Scale the adjoint matrix to get the inverse
this.m11 /= det;
this.m12 /= det;
this.m13 /= det;
this.m14 /= det;
this.m21 /= det;
this.m22 /= det;
this.m23 /= det;
this.m24 /= det;
this.m31 /= det;
this.m32 /= det;
this.m33 /= det;
this.m34 /= det;
this.m41 /= det;
this.m42 /= det;
this.m43 /= det;
this.m44 /= det;
};
CanvasMatrix4.prototype.translate = function(x,y,z)
{
if (x === undefined)
x = 0;
if (y === undefined)
y = 0;
if (z === undefined)
z = 0;
var matrix = new CanvasMatrix4();
matrix.m41 = x;
matrix.m42 = y;
matrix.m43 = z;
this.multRight(matrix);
};
CanvasMatrix4.prototype.scale = function(x,y,z)
{
if (x === undefined)
x = 1;
if (z === undefined) {
if (y === undefined) {
y = x;
z = x;
}
else
z = 1;
}
else if (y === undefined)
y = x;
var matrix = new CanvasMatrix4();
matrix.m11 = x;
matrix.m22 = y;
matrix.m33 = z;
this.multRight(matrix);
};
CanvasMatrix4.prototype.rotate = function(angle,x,y,z)
{
// angles are in degrees. Switch to radians
angle = angle / 180 * Math.PI;
angle /= 2;
var sinA = Math.sin(angle);
var cosA = Math.cos(angle);
var sinA2 = sinA * sinA;
// normalize
var length = Math.sqrt(x * x + y * y + z * z);
if (length === 0) {
// bad vector, just use something reasonable
x = 0;
y = 0;
z = 1;
} else if (length != 1) {
x /= length;
y /= length;
z /= length;
}
var mat = new CanvasMatrix4();
// optimize case where axis is along major axis
if (x == 1 && y === 0 && z === 0) {
mat.m11 = 1;
mat.m12 = 0;
mat.m13 = 0;
mat.m21 = 0;
mat.m22 = 1 - 2 * sinA2;
mat.m23 = 2 * sinA * cosA;
mat.m31 = 0;
mat.m32 = -2 * sinA * cosA;
mat.m33 = 1 - 2 * sinA2;
mat.m14 = mat.m24 = mat.m34 = 0;
mat.m41 = mat.m42 = mat.m43 = 0;
mat.m44 = 1;
} else if (x === 0 && y == 1 && z === 0) {
mat.m11 = 1 - 2 * sinA2;
mat.m12 = 0;
mat.m13 = -2 * sinA * cosA;
mat.m21 = 0;
mat.m22 = 1;
mat.m23 = 0;
mat.m31 = 2 * sinA * cosA;
mat.m32 = 0;
mat.m33 = 1 - 2 * sinA2;
mat.m14 = mat.m24 = mat.m34 = 0;
mat.m41 = mat.m42 = mat.m43 = 0;
mat.m44 = 1;
} else if (x === 0 && y === 0 && z == 1) {
mat.m11 = 1 - 2 * sinA2;
mat.m12 = 2 * sinA * cosA;
mat.m13 = 0;
mat.m21 = -2 * sinA * cosA;
mat.m22 = 1 - 2 * sinA2;
mat.m23 = 0;
mat.m31 = 0;
mat.m32 = 0;
mat.m33 = 1;
mat.m14 = mat.m24 = mat.m34 = 0;
mat.m41 = mat.m42 = mat.m43 = 0;
mat.m44 = 1;
} else {
var x2 = x*x;
var y2 = y*y;
var z2 = z*z;
mat.m11 = 1 - 2 * (y2 + z2) * sinA2;
mat.m12 = 2 * (x * y * sinA2 + z * sinA * cosA);
mat.m13 = 2 * (x * z * sinA2 - y * sinA * cosA);
mat.m21 = 2 * (y * x * sinA2 - z * sinA * cosA);
mat.m22 = 1 - 2 * (z2 + x2) * sinA2;
mat.m23 = 2 * (y * z * sinA2 + x * sinA * cosA);
mat.m31 = 2 * (z * x * sinA2 + y * sinA * cosA);
mat.m32 = 2 * (z * y * sinA2 - x * sinA * cosA);
mat.m33 = 1 - 2 * (x2 + y2) * sinA2;
mat.m14 = mat.m24 = mat.m34 = 0;
mat.m41 = mat.m42 = mat.m43 = 0;
mat.m44 = 1;
}
this.multRight(mat);
};
CanvasMatrix4.prototype.multRight = function(mat)
{
var m11 = (this.m11 * mat.m11 + this.m12 * mat.m21 +
this.m13 * mat.m31 + this.m14 * mat.m41);
var m12 = (this.m11 * mat.m12 + this.m12 * mat.m22 +
this.m13 * mat.m32 + this.m14 * mat.m42);
var m13 = (this.m11 * mat.m13 + this.m12 * mat.m23 +
this.m13 * mat.m33 + this.m14 * mat.m43);
var m14 = (this.m11 * mat.m14 + this.m12 * mat.m24 +
this.m13 * mat.m34 + this.m14 * mat.m44);
var m21 = (this.m21 * mat.m11 + this.m22 * mat.m21 +
this.m23 * mat.m31 + this.m24 * mat.m41);
var m22 = (this.m21 * mat.m12 + this.m22 * mat.m22 +
this.m23 * mat.m32 + this.m24 * mat.m42);
var m23 = (this.m21 * mat.m13 + this.m22 * mat.m23 +
this.m23 * mat.m33 + this.m24 * mat.m43);
var m24 = (this.m21 * mat.m14 + this.m22 * mat.m24 +
this.m23 * mat.m34 + this.m24 * mat.m44);
var m31 = (this.m31 * mat.m11 + this.m32 * mat.m21 +
this.m33 * mat.m31 + this.m34 * mat.m41);
var m32 = (this.m31 * mat.m12 + this.m32 * mat.m22 +
this.m33 * mat.m32 + this.m34 * mat.m42);
var m33 = (this.m31 * mat.m13 + this.m32 * mat.m23 +
this.m33 * mat.m33 + this.m34 * mat.m43);
var m34 = (this.m31 * mat.m14 + this.m32 * mat.m24 +
this.m33 * mat.m34 + this.m34 * mat.m44);
var m41 = (this.m41 * mat.m11 + this.m42 * mat.m21 +
this.m43 * mat.m31 + this.m44 * mat.m41);
var m42 = (this.m41 * mat.m12 + this.m42 * mat.m22 +
this.m43 * mat.m32 + this.m44 * mat.m42);
var m43 = (this.m41 * mat.m13 + this.m42 * mat.m23 +
this.m43 * mat.m33 + this.m44 * mat.m43);
var m44 = (this.m41 * mat.m14 + this.m42 * mat.m24 +
this.m43 * mat.m34 + this.m44 * mat.m44);
this.m11 = m11;
this.m12 = m12;
this.m13 = m13;
this.m14 = m14;
this.m21 = m21;
this.m22 = m22;
this.m23 = m23;
this.m24 = m24;
this.m31 = m31;
this.m32 = m32;
this.m33 = m33;
this.m34 = m34;
this.m41 = m41;
this.m42 = m42;
this.m43 = m43;
this.m44 = m44;
};
CanvasMatrix4.prototype.multLeft = function(mat)
{
var m11 = (mat.m11 * this.m11 + mat.m12 * this.m21 +
mat.m13 * this.m31 + mat.m14 * this.m41);
var m12 = (mat.m11 * this.m12 + mat.m12 * this.m22 +
mat.m13 * this.m32 + mat.m14 * this.m42);
var m13 = (mat.m11 * this.m13 + mat.m12 * this.m23 +
mat.m13 * this.m33 + mat.m14 * this.m43);
var m14 = (mat.m11 * this.m14 + mat.m12 * this.m24 +
mat.m13 * this.m34 + mat.m14 * this.m44);
var m21 = (mat.m21 * this.m11 + mat.m22 * this.m21 +
mat.m23 * this.m31 + mat.m24 * this.m41);
var m22 = (mat.m21 * this.m12 + mat.m22 * this.m22 +
mat.m23 * this.m32 + mat.m24 * this.m42);
var m23 = (mat.m21 * this.m13 + mat.m22 * this.m23 +
mat.m23 * this.m33 + mat.m24 * this.m43);
var m24 = (mat.m21 * this.m14 + mat.m22 * this.m24 +
mat.m23 * this.m34 + mat.m24 * this.m44);
var m31 = (mat.m31 * this.m11 + mat.m32 * this.m21 +
mat.m33 * this.m31 + mat.m34 * this.m41);
var m32 = (mat.m31 * this.m12 + mat.m32 * this.m22 +
mat.m33 * this.m32 + mat.m34 * this.m42);
var m33 = (mat.m31 * this.m13 + mat.m32 * this.m23 +
mat.m33 * this.m33 + mat.m34 * this.m43);
var m34 = (mat.m31 * this.m14 + mat.m32 * this.m24 +
mat.m33 * this.m34 + mat.m34 * this.m44);
var m41 = (mat.m41 * this.m11 + mat.m42 * this.m21 +
mat.m43 * this.m31 + mat.m44 * this.m41);
var m42 = (mat.m41 * this.m12 + mat.m42 * this.m22 +
mat.m43 * this.m32 + mat.m44 * this.m42);
var m43 = (mat.m41 * this.m13 + mat.m42 * this.m23 +
mat.m43 * this.m33 + mat.m44 * this.m43);
var m44 = (mat.m41 * this.m14 + mat.m42 * this.m24 +
mat.m43 * this.m34 + mat.m44 * this.m44);
this.m11 = m11;
this.m12 = m12;
this.m13 = m13;
this.m14 = m14;
this.m21 = m21;
this.m22 = m22;
this.m23 = m23;
this.m24 = m24;
this.m31 = m31;
this.m32 = m32;
this.m33 = m33;
this.m34 = m34;
this.m41 = m41;
this.m42 = m42;
this.m43 = m43;
this.m44 = m44;
};
CanvasMatrix4.prototype.ortho = function(left, right, bottom, top, near, far)
{
var tx = (left + right) / (left - right);
var ty = (top + bottom) / (bottom - top);
var tz = (far + near) / (near - far);
var matrix = new CanvasMatrix4();
matrix.m11 = 2 / (right - left);
matrix.m12 = 0;
matrix.m13 = 0;
matrix.m14 = 0;
matrix.m21 = 0;
matrix.m22 = 2 / (top - bottom);
matrix.m23 = 0;
matrix.m24 = 0;
matrix.m31 = 0;
matrix.m32 = 0;
matrix.m33 = -2 / (far - near);
matrix.m34 = 0;
matrix.m41 = tx;
matrix.m42 = ty;
matrix.m43 = tz;
matrix.m44 = 1;
this.multRight(matrix);
};
CanvasMatrix4.prototype.frustum = function(left, right, bottom, top, near, far)
{
var matrix = new CanvasMatrix4();
var A = (right + left) / (right - left);
var B = (top + bottom) / (top - bottom);
var C = -(far + near) / (far - near);
var D = -(2 * far * near) / (far - near);
matrix.m11 = (2 * near) / (right - left);
matrix.m12 = 0;
matrix.m13 = 0;
matrix.m14 = 0;
matrix.m21 = 0;
matrix.m22 = 2 * near / (top - bottom);
matrix.m23 = 0;
matrix.m24 = 0;
matrix.m31 = A;
matrix.m32 = B;
matrix.m33 = C;
matrix.m34 = -1;
matrix.m41 = 0;
matrix.m42 = 0;
matrix.m43 = D;
matrix.m44 = 0;
this.multRight(matrix);
};
CanvasMatrix4.prototype.perspective = function(fovy, aspect, zNear, zFar)
{
var top = Math.tan(fovy * Math.PI / 360) * zNear;
var bottom = -top;
var left = aspect * bottom;
var right = aspect * top;
this.frustum(left, right, bottom, top, zNear, zFar);
};
CanvasMatrix4.prototype.lookat = function(eyex, eyey, eyez, centerx, centery, centerz, upx, upy, upz)
{
var matrix = new CanvasMatrix4();
// Make rotation matrix
// Z vector
var zx = eyex - centerx;
var zy = eyey - centery;
var zz = eyez - centerz;
var mag = Math.sqrt(zx * zx + zy * zy + zz * zz);
if (mag) {
zx /= mag;
zy /= mag;
zz /= mag;
}
// Y vector
var yx = upx;
var yy = upy;
var yz = upz;
// X vector = Y cross Z
xx =  yy * zz - yz * zy;
xy = -yx * zz + yz * zx;
xz =  yx * zy - yy * zx;
// Recompute Y = Z cross X
yx = zy * xz - zz * xy;
yy = -zx * xz + zz * xx;
yx = zx * xy - zy * xx;
// cross product gives area of parallelogram, which is < 1.0 for
// non-perpendicular unit-length vectors; so normalize x, y here
mag = Math.sqrt(xx * xx + xy * xy + xz * xz);
if (mag) {
xx /= mag;
xy /= mag;
xz /= mag;
}
mag = Math.sqrt(yx * yx + yy * yy + yz * yz);
if (mag) {
yx /= mag;
yy /= mag;
yz /= mag;
}
matrix.m11 = xx;
matrix.m12 = xy;
matrix.m13 = xz;
matrix.m14 = 0;
matrix.m21 = yx;
matrix.m22 = yy;
matrix.m23 = yz;
matrix.m24 = 0;
matrix.m31 = zx;
matrix.m32 = zy;
matrix.m33 = zz;
matrix.m34 = 0;
matrix.m41 = 0;
matrix.m42 = 0;
matrix.m43 = 0;
matrix.m44 = 1;
matrix.translate(-eyex, -eyey, -eyez);
this.multRight(matrix);
};
// Support functions
CanvasMatrix4.prototype._determinant2x2 = function(a, b, c, d)
{
return a * d - b * c;
};
CanvasMatrix4.prototype._determinant3x3 = function(a1, a2, a3, b1, b2, b3, c1, c2, c3)
{
return a1 * this._determinant2x2(b2, b3, c2, c3) -
b1 * this._determinant2x2(a2, a3, c2, c3) +
c1 * this._determinant2x2(a2, a3, b2, b3);
};
CanvasMatrix4.prototype._determinant4x4 = function()
{
var a1 = this.m11;
var b1 = this.m12;
var c1 = this.m13;
var d1 = this.m14;
var a2 = this.m21;
var b2 = this.m22;
var c2 = this.m23;
var d2 = this.m24;
var a3 = this.m31;
var b3 = this.m32;
var c3 = this.m33;
var d3 = this.m34;
var a4 = this.m41;
var b4 = this.m42;
var c4 = this.m43;
var d4 = this.m44;
return a1 * this._determinant3x3(b2, b3, b4, c2, c3, c4, d2, d3, d4) -
b1 * this._determinant3x3(a2, a3, a4, c2, c3, c4, d2, d3, d4) +
c1 * this._determinant3x3(a2, a3, a4, b2, b3, b4, d2, d3, d4) -
d1 * this._determinant3x3(a2, a3, a4, b2, b3, b4, c2, c3, c4);
};
CanvasMatrix4.prototype._makeAdjoint = function()
{
var a1 = this.m11;
var b1 = this.m12;
var c1 = this.m13;
var d1 = this.m14;
var a2 = this.m21;
var b2 = this.m22;
var c2 = this.m23;
var d2 = this.m24;
var a3 = this.m31;
var b3 = this.m32;
var c3 = this.m33;
var d3 = this.m34;
var a4 = this.m41;
var b4 = this.m42;
var c4 = this.m43;
var d4 = this.m44;
// Row column labeling reversed since we transpose rows & columns
this.m11  =   this._determinant3x3(b2, b3, b4, c2, c3, c4, d2, d3, d4);
this.m21  = - this._determinant3x3(a2, a3, a4, c2, c3, c4, d2, d3, d4);
this.m31  =   this._determinant3x3(a2, a3, a4, b2, b3, b4, d2, d3, d4);
this.m41  = - this._determinant3x3(a2, a3, a4, b2, b3, b4, c2, c3, c4);
this.m12  = - this._determinant3x3(b1, b3, b4, c1, c3, c4, d1, d3, d4);
this.m22  =   this._determinant3x3(a1, a3, a4, c1, c3, c4, d1, d3, d4);
this.m32  = - this._determinant3x3(a1, a3, a4, b1, b3, b4, d1, d3, d4);
this.m42  =   this._determinant3x3(a1, a3, a4, b1, b3, b4, c1, c3, c4);
this.m13  =   this._determinant3x3(b1, b2, b4, c1, c2, c4, d1, d2, d4);
this.m23  = - this._determinant3x3(a1, a2, a4, c1, c2, c4, d1, d2, d4);
this.m33  =   this._determinant3x3(a1, a2, a4, b1, b2, b4, d1, d2, d4);
this.m43  = - this._determinant3x3(a1, a2, a4, b1, b2, b4, c1, c2, c4);
this.m14  = - this._determinant3x3(b1, b2, b3, c1, c2, c3, d1, d2, d3);
this.m24  =   this._determinant3x3(a1, a2, a3, c1, c2, c3, d1, d2, d3);
this.m34  = - this._determinant3x3(a1, a2, a3, b1, b2, b3, d1, d2, d3);
this.m44  =   this._determinant3x3(a1, a2, a3, b1, b2, b3, c1, c2, c3);
};</script>
<script>
rglwidgetClass = function() {
this.canvas = null;
this.userMatrix = new CanvasMatrix4();
this.types = [];
this.prMatrix = new CanvasMatrix4();
this.mvMatrix = new CanvasMatrix4();
this.vp = null;
this.prmvMatrix = null;
this.origs = null;
this.gl = null;
this.scene = null;
};
(function() {
this.multMV = function(M, v) {
return [ M.m11 * v[0] + M.m12 * v[1] + M.m13 * v[2] + M.m14 * v[3],
M.m21 * v[0] + M.m22 * v[1] + M.m23 * v[2] + M.m24 * v[3],
M.m31 * v[0] + M.m32 * v[1] + M.m33 * v[2] + M.m34 * v[3],
M.m41 * v[0] + M.m42 * v[1] + M.m43 * v[2] + M.m44 * v[3]
];
};
this.vlen = function(v) {
return Math.sqrt(this.dotprod(v, v));
};
this.dotprod = function(a, b) {
return a[0]*b[0] + a[1]*b[1] + a[2]*b[2];
};
this.xprod = function(a, b) {
return [a[1]*b[2] - a[2]*b[1],
a[2]*b[0] - a[0]*b[2],
a[0]*b[1] - a[1]*b[0]];
};
this.cbind = function(a, b) {
if (b.length < a.length)
b = this.repeatToLen(b, a.length);
else if (a.length < b.length)
a = this.repeatToLen(a, b.length);
return a.map(function(currentValue, index, array) {
return currentValue.concat(b[index]);
});
};
this.swap = function(a, i, j) {
var temp = a[i];
a[i] = a[j];
a[j] = temp;
};
this.flatten = function(a) {
return [].concat.apply([], a);
};
/* set element of 1d or 2d array as if it was flattened.  Column major, zero based! */
this.setElement = function(a, i, value) {
if (Array.isArray(a[0])) {
var dim = a.length,
col = Math.floor(i/dim),
row = i % dim;
a[row][col] = value;
} else {
a[i] = value;
}
};
this.transpose = function(a) {
var newArray = [],
n = a.length,
m = a[0].length,
i;
for(i = 0; i < m; i++){
newArray.push([]);
}
for(i = 0; i < n; i++){
for(var j = 0; j < m; j++){
newArray[j].push(a[i][j]);
}
}
return newArray;
};
this.sumsq = function(x) {
var result = 0, i;
for (i=0; i < x.length; i++)
result += x[i]*x[i];
return result;
};
this.toCanvasMatrix4 = function(mat) {
if (mat instanceof CanvasMatrix4)
return mat;
var result = new CanvasMatrix4();
mat = this.flatten(this.transpose(mat));
result.load(mat);
return result;
};
this.stringToRgb = function(s) {
s = s.replace("#", "");
var bigint = parseInt(s, 16);
return [((bigint >> 16) & 255)/255,
((bigint >> 8) & 255)/255,
(bigint & 255)/255];
};
this.componentProduct = function(x, y) {
if (typeof y === "undefined") {
this.alertOnce("Bad arg to componentProduct");
}
var result = new Float32Array(3), i;
for (i = 0; i<3; i++)
result[i] = x[i]*y[i];
return result;
};
this.getPowerOfTwo = function(value) {
var pow = 1;
while(pow<value) {
pow *= 2;
}
return pow;
};
this.unique = function(arr) {
arr = [].concat(arr);
return arr.filter(function(value, index, self) {
return self.indexOf(value) === index;
});
};
this.repeatToLen = function(arr, len) {
arr = [].concat(arr);
while (arr.length < len/2)
arr = arr.concat(arr);
return arr.concat(arr.slice(0, len - arr.length));
};
this.alertOnce = function(msg) {
if (typeof this.alerted !== "undefined")
return;
this.alerted = true;
alert(msg);
};
this.f_is_lit = 1;
this.f_is_smooth = 2;
this.f_has_texture = 4;
this.f_is_indexed = 8;
this.f_depth_sort = 16;
this.f_fixed_quads = 32;
this.f_is_transparent = 64;
this.f_is_lines = 128;
this.f_sprites_3d = 256;
this.f_sprite_3d = 512;
this.f_is_subscene = 1024;
this.f_is_clipplanes = 2048;
this.f_fixed_size = 4096;
this.f_is_points = 8192;
this.f_is_twosided = 16384;
this.whichList = function(id) {
var obj = this.getObj(id),
flags = obj.flags;
if (obj.type === "light")
return "lights";
if (flags & this.f_is_subscene)
return "subscenes";
if (flags & this.f_is_clipplanes)
return "clipplanes";
if (flags & this.f_is_transparent)
return "transparent";
return "opaque";
};
this.getObj = function(id) {
if (typeof id !== "number") {
this.alertOnce("getObj id is "+typeof id);
}
return this.scene.objects[id];
};
this.getIdsByType = function(type, subscene) {
var
result = [], i, self = this;
if (typeof subscene === "undefined") {
Object.keys(this.scene.objects).forEach(
function(key) {
key = parseInt(key, 10);
if (self.getObj(key).type === type)
result.push(key);
});
} else {
ids = this.getObj(subscene).objects;
for (i=0; i < ids.length; i++) {
if (this.getObj(ids[i]).type === type) {
result.push(ids[i]);
}
}
}
return result;
};
this.getMaterial = function(id, property) {
var obj = this.getObj(id),
mat = obj.material[property];
if (typeof mat === "undefined")
mat = this.scene.material[property];
return mat;
};
this.inSubscene = function(id, subscene) {
return this.getObj(subscene).objects.indexOf(id) > -1;
};
this.addToSubscene = function(id, subscene) {
var thelist,
thesub = this.getObj(subscene),
ids = [id],
obj = this.getObj(id), i;
if (typeof obj.newIds !== "undefined") {
ids = ids.concat(obj.newIds);
}
for (i = 0; i < ids.length; i++) {
id = ids[i];
if (thesub.objects.indexOf(id) == -1) {
thelist = this.whichList(id);
thesub.objects.push(id);
thesub[thelist].push(id);
}
}
};
this.delFromSubscene = function(id, subscene) {
var thelist,
thesub = this.getObj(subscene),
obj = this.getObj(id),
ids = [id], i;
if (typeof obj.newIds !== "undefined")
ids = ids.concat(obj.newIds);
for (j=0; j<ids.length;j++) {
id = ids[j];
i = thesub.objects.indexOf(id);
if (i > -1) {
thesub.objects.splice(i, 1);
thelist = this.whichList(id);
i = thesub[thelist].indexOf(id);
thesub[thelist].splice(i, 1);
}
}
};
this.setSubsceneEntries = function(ids, subsceneid) {
var sub = this.getObj(subsceneid);
sub.objects = ids;
this.initSubscene(subsceneid);
};
this.getSubsceneEntries = function(subscene) {
return this.getObj(subscene).objects;
};
this.getChildSubscenes = function(subscene) {
return this.getObj(subscene).subscenes;
};
this.startDrawing = function() {
var value = this.drawing;
this.drawing = true;
return value;
};
this.stopDrawing = function(saved) {
this.drawing = saved;
if (!saved && this.gl && this.gl.isContextLost())
this.restartCanvas();
};
this.getVertexShader = function(id) {
var obj = this.getObj(id),
userShader = obj.userVertexShader,
flags = obj.flags,
type = obj.type,
is_lit = flags & this.f_is_lit,
has_texture = flags & this.f_has_texture,
fixed_quads = flags & this.f_fixed_quads,
sprites_3d = flags & this.f_sprites_3d,
sprite_3d = flags & this.f_sprite_3d,
nclipplanes = this.countClipplanes(),
fixed_size = flags & this.f_fixed_size,
is_points = flags & this.f_is_points,
is_twosided = flags & this.f_is_twosided,
result;
if (type === "clipplanes" || sprites_3d) return;
if (typeof userShader !== "undefined") return userShader;
result = "  /* ****** "+type+" object "+id+" vertex shader ****** */\n"+
"  attribute vec3 aPos;\n"+
"  attribute vec4 aCol;\n"+
" uniform mat4 mvMatrix;\n"+
" uniform mat4 prMatrix;\n"+
" varying vec4 vCol;\n"+
" varying vec4 vPosition;\n";
if ((is_lit && !fixed_quads) || sprite_3d)
result = result + "  attribute vec3 aNorm;\n"+
" uniform mat4 normMatrix;\n"+
" varying vec3 vNormal;\n";
if (has_texture || type === "text")
result = result + " attribute vec2 aTexcoord;\n"+
" varying vec2 vTexcoord;\n";
if (fixed_size)
result = result + "  uniform vec2 textScale;\n";
if (fixed_quads)
result = result + "  attribute vec2 aOfs;\n";
else if (sprite_3d)
result = result + "  uniform vec3 uOrig;\n"+
"  uniform float uSize;\n"+
"  uniform mat4 usermat;\n";
if (is_twosided)
result = result + "  attribute vec3 aPos1;\n"+
"  attribute vec3 aPos2;\n"+
"  varying float normz;\n";
result = result + "  void main(void) {\n";
if (nclipplanes || (!fixed_quads && !sprite_3d))
result = result + "    vPosition = mvMatrix * vec4(aPos, 1.);\n";
if (!fixed_quads && !sprite_3d)
result = result + "    gl_Position = prMatrix * vPosition;\n";
if (is_points) {
var size = this.getMaterial(id, "size");
result = result + "    gl_PointSize = "+size.toFixed(1)+";\n";
}
result = result + "    vCol = aCol;\n";
if (is_lit && !fixed_quads && !sprite_3d)
result = result + "    vNormal = normalize((normMatrix * vec4(aNorm, 1.)).xyz);\n";
if (has_texture || type == "text")
result = result + "    vTexcoord = aTexcoord;\n";
if (fixed_size)
result = result + "    vec4 pos = prMatrix * mvMatrix * vec4(aPos, 1.);\n"+
"   pos = pos/pos.w;\n"+
"   gl_Position = pos + vec4(aOfs*textScale, 0.,0.);\n";
if (type == "sprites" && !fixed_size)
result = result + "    vec4 pos = mvMatrix * vec4(aPos, 1.);\n"+
"   pos = pos/pos.w + vec4(aOfs, 0., 0.);\n"+
"   gl_Position = prMatrix*pos;\n";
if (sprite_3d)
result = result + "   vNormal = normalize((normMatrix * vec4(aNorm, 1.)).xyz);\n"+
"   vec4 pos = mvMatrix * vec4(uOrig, 1.);\n"+
"   vPosition = pos/pos.w + vec4(uSize*(vec4(aPos, 1.)*usermat).xyz,0.);\n"+
"   gl_Position = prMatrix * vPosition;\n";
if (is_twosided)
result = result + "   vec4 pos1 = prMatrix*(mvMatrix*vec4(aPos1, 1.));\n"+
"   pos1 = pos1/pos1.w - gl_Position/gl_Position.w;\n"+
"   vec4 pos2 = prMatrix*(mvMatrix*vec4(aPos2, 1.));\n"+
"   pos2 = pos2/pos2.w - gl_Position/gl_Position.w;\n"+
"   normz = pos1.x*pos2.y - pos1.y*pos2.x;\n";
result = result + "  }\n";
// console.log(result);
return result;
};
this.getFragmentShader = function(id) {
var obj = this.getObj(id),
userShader = obj.userFragmentShader,
flags = obj.flags,
type = obj.type,
is_lit = flags & this.f_is_lit,
has_texture = flags & this.f_has_texture,
fixed_quads = flags & this.f_fixed_quads,
sprites_3d = flags & this.f_sprites_3d,
is_twosided = (flags & this.f_is_twosided) > 0,
nclipplanes = this.countClipplanes(), i,
texture_format, nlights,
result;
if (type === "clipplanes" || sprites_3d) return;
if (typeof userShader !== "undefined") return userShader;
if (has_texture)
texture_format = this.getMaterial(id, "textype");
result = "/* ****** "+type+" object "+id+" fragment shader ****** */\n"+
"#ifdef GL_ES\n"+
"  precision highp float;\n"+
"#endif\n"+
"  varying vec4 vCol; // carries alpha\n"+
"  varying vec4 vPosition;\n";
if (has_texture || type === "text")
result = result + "  varying vec2 vTexcoord;\n"+
" uniform sampler2D uSampler;\n";
if (is_lit && !fixed_quads)
result = result + "  varying vec3 vNormal;\n";
for (i = 0; i < nclipplanes; i++)
result = result + "  uniform vec4 vClipplane"+i+";\n";
if (is_lit) {
nlights = this.countLights();
if (nlights)
result = result + "  uniform mat4 mvMatrix;\n";
else
is_lit = false;
}
if (is_lit) {
result = result + "   uniform vec3 emission;\n"+
"   uniform float shininess;\n";
for (i=0; i < nlights; i++) {
result = result + "   uniform vec3 ambient" + i + ";\n"+
"   uniform vec3 specular" + i +"; // light*material\n"+
"   uniform vec3 diffuse" + i + ";\n"+
"   uniform vec3 lightDir" + i + ";\n"+
"   uniform bool viewpoint" + i + ";\n"+
"   uniform bool finite" + i + ";\n";
}
}
if (is_twosided) 
result = result + "   uniform bool front;\n"+
"   varying float normz;\n";
result = result + "  void main(void) {\n";
for (i=0; i < nclipplanes;i++)
result = result + "    if (dot(vPosition, vClipplane"+i+") < 0.0) discard;\n";
if (fixed_quads) {
result = result +   "    vec3 n = vec3(0., 0., 1.);\n"; 
} else if (is_lit) {
result = result +   "    vec3 n = normalize(vNormal);\n";
}
if (is_twosided) {
result = result +   "    if ((normz <= 0.) != front) discard;";
}
if (is_lit) {
result = result + "    vec3 eye = normalize(-vPosition.xyz);\n"+
"   vec3 lightdir;\n"+
"   vec4 colDiff;\n"+
"   vec3 halfVec;\n"+
"   vec4 lighteffect = vec4(emission, 0.);\n"+
"   vec3 col;\n"+
"   float nDotL;\n";
if (!fixed_quads) {
result = result +   "   n = -faceforward(n, n, eye);\n";
}
for (i=0; i < nlights; i++) {
result = result + "   colDiff = vec4(vCol.rgb * diffuse" + i + ", vCol.a);\n"+
"   lightdir = lightDir" + i + ";\n"+
"   if (!viewpoint" + i +")\n"+
"     lightdir = (mvMatrix * vec4(lightdir, 1.)).xyz;\n"+
"   if (!finite" + i + ") {\n"+
"     halfVec = normalize(lightdir + eye);\n"+
"   } else {\n"+
"     lightdir = normalize(lightdir - vPosition.xyz);\n"+
"     halfVec = normalize(lightdir + eye);\n"+
"   }\n"+
"    col = ambient" + i + ";\n"+
"   nDotL = dot(n, lightdir);\n"+
"   col = col + max(nDotL, 0.) * colDiff.rgb;\n"+
"   col = col + pow(max(dot(halfVec, n), 0.), shininess) * specular" + i + ";\n"+
"   lighteffect = lighteffect + vec4(col, colDiff.a);\n";
}
} else {
result = result +   "   vec4 colDiff = vCol;\n"+
"    vec4 lighteffect = colDiff;\n";
}
if (type === "text")
result = result +   "    vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);\n";
if (has_texture) {
result = result + {
rgb:            "   vec4 textureColor = lighteffect*vec4(texture2D(uSampler, vTexcoord).rgb, 1.);\n",
rgba:           "   vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);\n",
alpha:          "   vec4 textureColor = texture2D(uSampler, vTexcoord);\n"+
"   float luminance = dot(vec3(1.,1.,1.), textureColor.rgb)/3.;\n"+
"   textureColor =  vec4(lighteffect.rgb, lighteffect.a*luminance);\n",
luminance:      "   vec4 textureColor = vec4(lighteffect.rgb*dot(texture2D(uSampler, vTexcoord).rgb, vec3(1.,1.,1.))/3., lighteffect.a);\n",
"luminance.alpha":"    vec4 textureColor = texture2D(uSampler, vTexcoord);\n"+
"   float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;\n"+
"   textureColor = vec4(lighteffect.rgb*luminance, lighteffect.a*textureColor.a);\n"
}[texture_format]+
"   gl_FragColor = textureColor;\n";
} else if (type === "text") {
result = result +   "    if (textureColor.a < 0.1)\n"+
"     discard;\n"+
"   else\n"+
"     gl_FragColor = textureColor;\n";
} else
result = result +   "   gl_FragColor = lighteffect;\n";
result = result + "  }\n";
// console.log(result);
return result;
};
this.getShader = function(shaderType, code) {
var gl = this.gl, shader;
shader = gl.createShader(shaderType);
gl.shaderSource(shader, code);
gl.compileShader(shader);
if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS) && !gl.isContextLost())
alert(gl.getShaderInfoLog(shader));
return shader;
};
this.handleLoadedTexture = function(texture, textureCanvas) { 
var gl = this.gl || this.initGL();
gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, true);
gl.bindTexture(gl.TEXTURE_2D, texture);
gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, textureCanvas);
gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);
gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR_MIPMAP_NEAREST);
gl.generateMipmap(gl.TEXTURE_2D);
gl.bindTexture(gl.TEXTURE_2D, null);
};
this.loadImageToTexture = function(uri, texture) {
var canvas = this.textureCanvas,
ctx = canvas.getContext("2d"),
image = new Image(),
self = this;
image.onload = function() {
var w = image.width,
h = image.height,
canvasX = self.getPowerOfTwo(w),
canvasY = self.getPowerOfTwo(h),
gl = self.gl || self.initGL(),
maxTexSize = gl.getParameter(gl.MAX_TEXTURE_SIZE);
if (maxTexSize > 4096) maxTexSize = 4096;
while (canvasX > 1 && canvasY > 1 && (canvasX > maxTexSize || canvasY > maxTexSize)) {
canvasX /= 2;
canvasY /= 2;
}
canvas.width = canvasX;
canvas.height = canvasY;
ctx.imageSmoothingEnabled = true;
ctx.drawImage(image, 0, 0, canvasX, canvasY);
self.handleLoadedTexture(texture, canvas);
self.drawScene();
};
image.src = uri;
};
this.drawTextToCanvas = function(text, cex, family, font) {
var canvasX, canvasY,
textY,
scaling = 20,
textColour = "white",
backgroundColour = "rgba(0,0,0,0)",
canvas = this.textureCanvas,
ctx = canvas.getContext("2d"),
i, textHeights = [], widths = [], offset = 0, offsets = [],
fontStrings = [],
getFontString = function(i) {
textHeights[i] = scaling*cex[i];
var fontString = textHeights[i] + "px",
family0 = family[i],
font0 = font[i];
if (family0 === "sans")
family0 = "sans-serif";
else if (family0 === "mono")
family0 = "monospace";
fontString = fontString + " " + family0;
if (font0 === 2 || font0 === 4)
fontString = "bold " + fontString;
if (font0 === 3 || font0 === 4)
fontString = "italic " + fontString;
return fontString;
};
cex = this.repeatToLen(cex, text.length);
family = this.repeatToLen(family, text.length);
font = this.repeatToLen(font, text.length);
canvasX = 1;
for (i = 0; i < text.length; i++)  {
ctx.font = fontStrings[i] = getFontString(i);
widths[i] = ctx.measureText(text[i]).width;
offset = offsets[i] = offset + 2*textHeights[i];
canvasX = (widths[i] > canvasX) ? widths[i] : canvasX;
}
canvasX = this.getPowerOfTwo(canvasX);
canvasY = this.getPowerOfTwo(offset);
canvas.width = canvasX;
canvas.height = canvasY;
ctx.fillStyle = backgroundColour;
ctx.fillRect(0, 0, ctx.canvas.width, ctx.canvas.height);
ctx.textBaseline = "alphabetic";
for(i = 0; i < text.length; i++) {
textY = offsets[i];
ctx.font = fontStrings[i];
ctx.fillStyle = textColour;
ctx.textAlign = "left";
ctx.fillText(text[i], 0,  textY);
}
return {canvasX:canvasX, canvasY:canvasY,
widths:widths, textHeights:textHeights,
offsets:offsets};
};
this.setViewport = function(id) {
var gl = this.gl || this.initGL(),
vp = this.getObj(id).par3d.viewport,
x = vp.x*this.canvas.width,
y = vp.y*this.canvas.height,
width = vp.width*this.canvas.width,
height = vp.height*this.canvas.height;
this.vp = {x:x, y:y, width:width, height:height};
gl.viewport(x, y, width, height);
gl.scissor(x, y, width, height);
gl.enable(gl.SCISSOR_TEST);
};
this.setprMatrix = function(id) {
var subscene = this.getObj(id),
embedding = subscene.embeddings.projection;
if (embedding === "replace")
this.prMatrix.makeIdentity();
else
this.setprMatrix(subscene.parent);
if (embedding === "inherit")
return;
// This is based on the Frustum::enclose code from geom.cpp
var bbox = subscene.par3d.bbox,
scale = subscene.par3d.scale,
ranges = [(bbox[1]-bbox[0])*scale[0]/2,
(bbox[3]-bbox[2])*scale[1]/2,
(bbox[5]-bbox[4])*scale[2]/2],
radius = Math.sqrt(this.sumsq(ranges))*1.1; // A bit bigger to handle labels
if (radius <= 0) radius = 1;
var observer = subscene.par3d.observer,
distance = observer[2],
FOV = subscene.par3d.FOV, ortho = FOV === 0,
t = ortho ? 1 : Math.tan(FOV*Math.PI/360),
near = distance - radius,
far = distance + radius,
hlen,
aspect = this.vp.width/this.vp.height,
z = subscene.par3d.zoom;
if (far < 0.)
far = 1.;
if (near < far/100.)
near = far/100.;
hlen = t*near;
if (ortho) {
if (aspect > 1)
this.prMatrix.ortho(-hlen*aspect*z, hlen*aspect*z,
-hlen*z, hlen*z, near, far);
else
this.prMatrix.ortho(-hlen*z, hlen*z,
-hlen*z/aspect, hlen*z/aspect,
near, far);
} else {
if (aspect > 1)
this.prMatrix.frustum(-hlen*aspect*z, hlen*aspect*z,
-hlen*z, hlen*z, near, far);
else
this.prMatrix.frustum(-hlen*z, hlen*z,
-hlen*z/aspect, hlen*z/aspect,
near, far);
}
};
this.setmvMatrix = function(id) {
var observer = this.getObj(id).par3d.observer;
this.mvMatrix.makeIdentity();
this.setmodelMatrix(id);
this.mvMatrix.translate(-observer[0], -observer[1], -observer[2]);
};
this.setmodelMatrix = function(id) {
var subscene = this.getObj(id),
embedding = subscene.embeddings.model;
if (embedding !== "inherit") {
var scale = subscene.par3d.scale,
bbox = subscene.par3d.bbox,
center = [(bbox[0]+bbox[1])/2,
(bbox[2]+bbox[3])/2,
(bbox[4]+bbox[5])/2];
this.mvMatrix.translate(-center[0], -center[1], -center[2]);
this.mvMatrix.scale(scale[0], scale[1], scale[2]);
this.mvMatrix.multRight( subscene.par3d.userMatrix );
}
if (embedding !== "replace")
this.setmodelMatrix(subscene.parent);
};
this.setnormMatrix = function(subsceneid) {
var self = this,
recurse = function(id) {
var sub = self.getObj(id),
embedding = sub.embeddings.model;
if (embedding !== "inherit") {
var scale = sub.par3d.scale;
self.normMatrix.scale(1/scale[0], 1/scale[1], 1/scale[2]);
self.normMatrix.multRight(sub.par3d.userMatrix);
}
if (embedding !== "replace")
recurse(sub.parent);
};
self.normMatrix.makeIdentity();
recurse(subsceneid);
};
this.setprmvMatrix = function() {
this.prmvMatrix = new CanvasMatrix4( this.mvMatrix );
this.prmvMatrix.multRight( this.prMatrix );
};
this.countClipplanes = function() {
return this.countObjs("clipplanes");
};
this.countLights = function() {
return this.countObjs("light");
};
this.countObjs = function(type) {
var self = this,
bound = 0;
Object.keys(this.scene.objects).forEach(
function(key) {
if (self.getObj(parseInt(key, 10)).type === type)
bound = bound + 1;
});
return bound;
};
this.initSubscene = function(id) {
var sub = this.getObj(id),
i, obj;
if (sub.type !== "subscene")
return;
sub.par3d.userMatrix = this.toCanvasMatrix4(sub.par3d.userMatrix);
sub.par3d.listeners = [].concat(sub.par3d.listeners);
sub.backgroundId = undefined;
sub.subscenes = [];
sub.clipplanes = [];
sub.transparent = [];
sub.opaque = [];
sub.lights = [];
for (i=0; i < sub.objects.length; i++) {
obj = this.getObj(sub.objects[i]);
if (typeof obj === "undefined") {
sub.objects.splice(i, 1);
i--;
} else if (obj.type === "background")
sub.backgroundId = obj.id;
else
sub[this.whichList(obj.id)].push(obj.id);
}
};
this.copyObj = function(id, reuse) {
var obj = this.getObj(id),
prev = document.getElementById(reuse);
if (prev !== null) {
prev = prev.rglinstance;
var
prevobj = prev.getObj(id),
fields = ["flags", "type",
"colors", "vertices", "centers",
"normals", "offsets",
"texts", "cex", "family", "font", "adj",
"material",
"radii",
"texcoords",
"userMatrix", "ids",
"dim",
"par3d", "userMatrix",
"viewpoint", "finite"],
i;
for (i = 0; i < fields.length; i++) {
if (typeof prevobj[fields[i]] !== "undefined")
obj[fields[i]] = prevobj[fields[i]];
}
} else
console.warn("copyObj failed");
};
this.planeUpdateTriangles = function(id, bbox) {
var perms = [[0,0,1], [1,2,2], [2,1,0]],
x, xrow, elem, A, d, nhits, i, j, k, u, v, w, intersect, which, v0, v2, vx, reverse,
face1 = [], face2 = [], normals = [],
obj = this.getObj(id),
nPlanes = obj.normals.length;
obj.bbox = bbox;
obj.vertices = [];
obj.initialized = false;
for (elem = 0; elem < nPlanes; elem++) {
//    Vertex Av = normal.getRecycled(elem);
x = [];
A = obj.normals[elem];
d = obj.offsets[elem][0];
nhits = 0;
for (i=0; i<3; i++)
for (j=0; j<2; j++)
for (k=0; k<2; k++) {
u = perms[0][i];
v = perms[1][i];
w = perms[2][i];
if (A[w] !== 0.0) {
intersect = -(d + A[u]*bbox[j+2*u] + A[v]*bbox[k+2*v])/A[w];
if (bbox[2*w] < intersect && intersect < bbox[1+2*w]) {
xrow = [];
xrow[u] = bbox[j+2*u];
xrow[v] = bbox[k+2*v];
xrow[w] = intersect;
x.push(xrow);
face1[nhits] = j + 2*u;
face2[nhits] = k + 2*v;
nhits++;
}
}
}
if (nhits > 3) {
/* Re-order the intersections so the triangles work */
for (i=0; i<nhits-2; i++) {
which = 0; /* initialize to suppress warning */
for (j=i+1; j<nhits; j++) {
if (face1[i] == face1[j] || face1[i] == face2[j] ||
face2[i] == face1[j] || face2[i] == face2[j] ) {
which = j;
break;
}
}
if (which > i+1) {
this.swap(x, i+1, which);
this.swap(face1, i+1, which);
this.swap(face2, i+1, which);
}
}
}
if (nhits >= 3) {
/* Put in order so that the normal points out the FRONT of the faces */
v0 = [x[0][0] - x[1][0] , x[0][1] - x[1][1], x[0][2] - x[1][2]];
v2 = [x[2][0] - x[1][0] , x[2][1] - x[1][1], x[2][2] - x[1][2]];
/* cross-product */
vx = this.xprod(v0, v2);
reverse = this.dotprod(vx, A) > 0;
for (i=0; i<nhits-2; i++) {
obj.vertices.push(x[0]);
normals.push(A);
for (j=1; j<3; j++) {
obj.vertices.push(x[i + (reverse ? 3-j : j)]);
normals.push(A);
}
}
}
}
obj.pnormals = normals;
};
this.initObj = function(id) {
var obj = this.getObj(id),
flags = obj.flags,
type = obj.type,
is_indexed = flags & this.f_is_indexed,
is_lit = flags & this.f_is_lit,
has_texture = flags & this.f_has_texture,
fixed_quads = flags & this.f_fixed_quads,
depth_sort = flags & this.f_depth_sort,
sprites_3d = flags & this.f_sprites_3d,
sprite_3d = flags & this.f_sprite_3d,
fixed_size = flags & this.f_fixed_size,
is_twosided = (flags & this.f_is_twosided) > 0,
gl = this.gl || this.initGL(),
texinfo, drawtype, nclipplanes, f, nrows,
i,j,v,v1,v2, mat, uri, matobj, pass, pmode,
dim, nx, nz, attr;
if (typeof id !== "number") {
this.alertOnce("initObj id is "+typeof id);
}
obj.initialized = true;
if (type === "bboxdeco" || type === "subscene")
return;
if (type === "light") {
obj.ambient = new Float32Array(obj.colors[0].slice(0,3));
obj.diffuse = new Float32Array(obj.colors[1].slice(0,3));
obj.specular = new Float32Array(obj.colors[2].slice(0,3));
obj.lightDir = new Float32Array(obj.vertices[0]);
return;
}
if (type === "clipplanes") {
obj.vClipplane = this.flatten(this.cbind(obj.normals, obj.offsets));
return;
}
if (type == "background" && typeof obj.ids !== "undefined") {
obj.quad = this.flatten([].concat(obj.ids));
return;
}
if (typeof obj.vertices === "undefined")
obj.vertices = [];
v = obj.vertices;
obj.vertexCount = v.length;
if (!obj.vertexCount) return;
if (is_twosided) {
if (typeof obj.userAttributes === "undefined")
obj.userAttributes = {};
v1 = Array(v.length);
v2 = Array(v.length);  
if (obj.type == "triangles" || obj.type == "quads") {
if (obj.type == "triangles")
nrow = 3;
else
nrow = 4;
for (i=0; i<Math.floor(v.length/nrow); i++)
for (j=0; j<nrow; j++) {
v1[nrow*i + j] = v[nrow*i + ((j+1) % nrow)];
v2[nrow*i + j] = v[nrow*i + ((j+2) % nrow)];
}
} else if (obj.type == "surface") {
dim = obj.dim[0];
nx = dim[0];
nz = dim[1];
for (j=0; j<nx; j++) {
for (i=0; i<nz; i++) {
if (i+1 < nz && j+1 < nx) { 
v2[j + nx*i] = v[j + nx*(i+1)];
v1[j + nx*i] = v[j+1 + nx*(i+1)];
} else if (i+1 < nz) {
v2[j + nx*i] = v[j-1 + nx*i];
v1[j + nx*i] = v[j + nx*(i+1)];             
} else {
v2[j + nx*i] = v[j + nx*(i-1)];
v1[j + nx*i] = v[j-1 + nx*(i-1)];
}
}
}
}
obj.userAttributes.aPos1 = v1;
obj.userAttributes.aPos2 = v2;
}
if (!sprites_3d) {
if (gl.isContextLost()) return;
obj.prog = gl.createProgram();
gl.attachShader(obj.prog, this.getShader( gl.VERTEX_SHADER,
this.getVertexShader(id) ));
gl.attachShader(obj.prog, this.getShader( gl.FRAGMENT_SHADER,
this.getFragmentShader(id) ));
//  Force aPos to location 0, aCol to location 1
gl.bindAttribLocation(obj.prog, 0, "aPos");
gl.bindAttribLocation(obj.prog, 1, "aCol");
gl.linkProgram(obj.prog);
var linked = gl.getProgramParameter(obj.prog, gl.LINK_STATUS);
if (!linked) {
// An error occurred while linking
var lastError = gl.getProgramInfoLog(obj.prog);
console.warn("Error in program linking:" + lastError);
gl.deleteProgram(obj.prog);
return;
}
}
if (type === "text") {
texinfo = this.drawTextToCanvas(obj.texts,
this.flatten(obj.cex),
this.flatten(obj.family),
this.flatten(obj.family));
}
if (fixed_quads && !sprites_3d) {
obj.ofsLoc = gl.getAttribLocation(obj.prog, "aOfs");
}
if (sprite_3d) {
obj.origLoc = gl.getUniformLocation(obj.prog, "uOrig");
obj.sizeLoc = gl.getUniformLocation(obj.prog, "uSize");
obj.usermatLoc = gl.getUniformLocation(obj.prog, "usermat");
}
if (has_texture || type == "text") {
obj.texture = gl.createTexture();
obj.texLoc = gl.getAttribLocation(obj.prog, "aTexcoord");
obj.sampler = gl.getUniformLocation(obj.prog, "uSampler");
}
if (has_texture) {
mat = obj.material;
if (typeof mat.uri !== "undefined")
uri = mat.uri;
else if (typeof mat.uriElementId === "undefined") {
matobj = this.getObj(mat.uriId);
if (typeof matobj !== "undefined") {
uri = matobj.material.uri;
} else {
uri = "";
}
} else
uri = document.getElementById(mat.uriElementId).rglinstance.getObj(mat.uriId).material.uri;
this.loadImageToTexture(uri, obj.texture);
}
if (type === "text") {
this.handleLoadedTexture(obj.texture, this.textureCanvas);
}
var stride = 3, nc, cofs, nofs, radofs, oofs, tofs, vnew;
nc = obj.colorCount = obj.colors.length;
if (nc > 1) {
cofs = stride;
stride = stride + 4;
v = this.cbind(v, obj.colors);
} else {
cofs = -1;
obj.onecolor = this.flatten(obj.colors);
}
if (typeof obj.normals !== "undefined") {
nofs = stride;
stride = stride + 3;
v = this.cbind(v, typeof obj.pnormals !== "undefined" ? obj.pnormals : obj.normals);
} else
nofs = -1;
if (typeof obj.radii !== "undefined") {
radofs = stride;
stride = stride + 1;
// FIXME:  always concat the radii?
if (obj.radii.length === v.length) {
v = this.cbind(v, obj.radii);
} else if (obj.radii.length === 1) {
v = v.map(function(row, i, arr) { return row.concat(obj.radii[0]);});
}
} else
radofs = -1;
if (type == "sprites" && !sprites_3d) {
tofs = stride;
stride += 2;
oofs = stride;
stride += 2;
vnew = new Array(4*v.length);
var rescale = fixed_size ? 72 : 1,
size = obj.radii, s = rescale*size[0]/2;
for (i=0; i < v.length; i++) {
if (size.length > 1)
s = rescale*size[i]/2;
vnew[4*i]  = v[i].concat([0,0,-s,-s]);
vnew[4*i+1]= v[i].concat([1,0, s,-s]);
vnew[4*i+2]= v[i].concat([1,1, s, s]);
vnew[4*i+3]= v[i].concat([0,1,-s, s]);
}
v = vnew;
obj.vertexCount = v.length;
} else if (type === "text") {
tofs = stride;
stride += 2;
oofs = stride;
stride += 2;
vnew = new Array(4*v.length);
for (i=0; i < v.length; i++) {
vnew[4*i]  = v[i].concat([0,-0.5]).concat(obj.adj[0]);
vnew[4*i+1]= v[i].concat([1,-0.5]).concat(obj.adj[0]);
vnew[4*i+2]= v[i].concat([1, 1.5]).concat(obj.adj[0]);
vnew[4*i+3]= v[i].concat([0, 1.5]).concat(obj.adj[0]);
for (j=0; j < 4; j++) {
v1 = vnew[4*i+j];
v1[tofs+2] = 2*(v1[tofs]-v1[tofs+2])*texinfo.widths[i];
v1[tofs+3] = 2*(v1[tofs+1]-v1[tofs+3])*texinfo.textHeights[i];
v1[tofs] *= texinfo.widths[i]/texinfo.canvasX;
v1[tofs+1] = 1.0-(texinfo.offsets[i] -
v1[tofs+1]*texinfo.textHeights[i])/texinfo.canvasY;
vnew[4*i+j] = v1;
}
}
v = vnew;
obj.vertexCount = v.length;
} else if (typeof obj.texcoords !== "undefined") {
tofs = stride;
stride += 2;
oofs = -1;
v = this.cbind(v, obj.texcoords);
} else {
tofs = -1;
oofs = -1;
}
if (typeof obj.userAttributes !== "undefined") {
obj.userAttribOffsets = {};
obj.userAttribLocations = {};
obj.userAttribSizes = {};
for (attr in obj.userAttributes) {
obj.userAttribLocations[attr] = gl.getAttribLocation(obj.prog, attr);
if (obj.userAttribLocations[attr] >= 0) { // Attribute may not have been used
obj.userAttribOffsets[attr] = stride;
v = this.cbind(v, obj.userAttributes[attr]);
stride = v[0].length;
obj.userAttribSizes[attr] = stride - obj.userAttribOffsets[attr];
}
}
}
if (typeof obj.userUniforms !== "undefined") {
obj.userUniformLocations = {};
for (attr in obj.userUniforms) 
obj.userUniformLocations[attr] = gl.getUniformLocation(obj.prog, attr);
}
if (stride !== v[0].length) {
this.alertOnce("problem in stride calculation");
}
obj.vOffsets = {vofs:0, cofs:cofs, nofs:nofs, radofs:radofs, oofs:oofs, tofs:tofs, stride:stride};
obj.values = new Float32Array(this.flatten(v));
if (sprites_3d) {
obj.userMatrix = new CanvasMatrix4(obj.userMatrix);
obj.objects = this.flatten([].concat(obj.ids));
is_lit = false;
}
if (is_lit && !fixed_quads) {
obj.normLoc = gl.getAttribLocation(obj.prog, "aNorm");
}
nclipplanes = this.countClipplanes();
if (nclipplanes && !sprites_3d) {
obj.clipLoc = [];
for (i=0; i < nclipplanes; i++)
obj.clipLoc[i] = gl.getUniformLocation(obj.prog,"vClipplane" + i);
}
if (is_lit) {
obj.emissionLoc = gl.getUniformLocation(obj.prog, "emission");
obj.emission = new Float32Array(this.stringToRgb(this.getMaterial(id, "emission")));
obj.shininessLoc = gl.getUniformLocation(obj.prog, "shininess");
obj.shininess = this.getMaterial(id, "shininess");
obj.nlights = this.countLights();
obj.ambientLoc = [];
obj.ambient = new Float32Array(this.stringToRgb(this.getMaterial(id, "ambient")));
obj.specularLoc = [];
obj.specular = new Float32Array(this.stringToRgb(this.getMaterial(id, "specular")));
obj.diffuseLoc = [];
obj.lightDirLoc = [];
obj.viewpointLoc = [];
obj.finiteLoc = [];
for (i=0; i < obj.nlights; i++) {
obj.ambientLoc[i] = gl.getUniformLocation(obj.prog, "ambient" + i);
obj.specularLoc[i] = gl.getUniformLocation(obj.prog, "specular" + i);
obj.diffuseLoc[i] = gl.getUniformLocation(obj.prog, "diffuse" + i);
obj.lightDirLoc[i] = gl.getUniformLocation(obj.prog, "lightDir" + i);
obj.viewpointLoc[i] = gl.getUniformLocation(obj.prog, "viewpoint" + i);
obj.finiteLoc[i] = gl.getUniformLocation(obj.prog, "finite" + i);
}
}
if (is_indexed) {
obj.f = Array(2);
for (pass = 0; pass < is_twosided + 1; pass++) {
if (type === "triangles" || type === "quads" || type === "surface")
pmode = this.getMaterial(id, (pass === 0) ? "front" : "back");
else pmode = "filled";
if (pmode === "culled")
continue;
if (pmode === "points") {
nrows = obj.vertexCount;
f = Array(nrows);
for (i=0; i < nrows; i++)
f[i] = i;
} else if ((type === "quads" || type === "text" ||
type === "sprites") && !sprites_3d) {
nrows = Math.floor(obj.vertexCount/4);
if (pmode === "filled") {
f = Array(6*nrows);
for (i=0; i < nrows; i++) {
f[6*i] = 4*i;
f[6*i+1] = 4*i + 1;
f[6*i+2] = 4*i + 2;
f[6*i+3] = 4*i;
f[6*i+4] = 4*i + 2;
f[6*i+5] = 4*i + 3;
}
} else {
f = Array(8*nrows);
for (i=0; i < nrows; i++) {
f[8*i] = 4*i;
f[8*i+1] = 4*i + 1;
f[8*i+2] = 4*i + 1;
f[8*i+3] = 4*i + 2;
f[8*i+4] = 4*i + 2;
f[8*i+5] = 4*i + 3;
f[8*i+6] = 4*i + 3;
f[8*i+7] = 4*i;
}
}
} else if (type === "triangles") {
nrows = Math.floor(obj.vertexCount/3);
if (pmode === "filled") {
f = Array(3*nrows);
for (i=0; i < f.length; i++) {
f[i] = i;
}
} else if (pmode === "lines") {
f = Array(6*nrows);
for (i=0; i < nrows; i++) {
f[6*i] = 3*i;
f[6*i + 1] = 3*i + 1;
f[6*i + 2] = 3*i + 1;
f[6*i + 3] = 3*i + 2;
f[6*i + 4] = 3*i + 2;  
f[6*i + 5] = 3*i;         
}
}
} else if (type === "spheres") {
nrows = obj.vertexCount;
f = Array(nrows);
for (i=0; i < f.length; i++) {
f[i] = i;
}
} else if (type === "surface") {
dim = obj.dim[0];
nx = dim[0];
nz = dim[1];
if (pmode === "filled") {
f = [];
for (j=0; j<nx-1; j++) {
for (i=0; i<nz-1; i++) {
f.push(j + nx*i,
j + nx*(i+1),
j + 1 + nx*(i+1),
j + nx*i,
j + 1 + nx*(i+1),
j + 1 + nx*i);
} 
}
} else if (pmode === "lines") {
f = [];
for (j=0; j<nx; j++) {
for (i=0; i<nz; i++) {
if (i+1 < nz)
f.push(j + nx*i,
j + nx*(i+1));
if (j+1 < nx)
f.push(j + nx*i,
j+1 + nx*i);
}
}
}
}
obj.f[pass] = new Uint16Array(f);
if (depth_sort) {
drawtype = "DYNAMIC_DRAW";
} else {
drawtype = "STATIC_DRAW";
}
}
}
if (type !== "spheres" && !sprites_3d) {
obj.buf = gl.createBuffer();
gl.bindBuffer(gl.ARRAY_BUFFER, obj.buf);
gl.bufferData(gl.ARRAY_BUFFER, obj.values, gl.STATIC_DRAW); //
}
if (is_indexed && type !== "spheres" && !sprites_3d) {
obj.ibuf = Array(is_twosided + 1);
obj.ibuf[0] = gl.createBuffer();
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, obj.ibuf[0]);
gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, obj.f[0], gl[drawtype]);
if (is_twosided) {
obj.ibuf[1] = gl.createBuffer();
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, obj.ibuf[1]);
gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, obj.f[1], gl[drawtype]);
}
}
if (!sprites_3d) {
obj.mvMatLoc = gl.getUniformLocation(obj.prog, "mvMatrix");
obj.prMatLoc = gl.getUniformLocation(obj.prog, "prMatrix");
}
if (fixed_size) {
obj.textScaleLoc = gl.getUniformLocation(obj.prog, "textScale");
}
if (is_lit && !sprites_3d) {
obj.normMatLoc = gl.getUniformLocation(obj.prog, "normMatrix");
}
if (is_twosided) {
obj.frontLoc = gl.getUniformLocation(obj.prog, "front");
}
};
this.setDepthTest = function(id) {
var gl = this.gl || this.initGL(),
tests = {never: gl.NEVER,
less:  gl.LESS,
equal: gl.EQUAL,
lequal:gl.LEQUAL,
greater: gl.GREATER,
notequal: gl.NOTEQUAL,
gequal: gl.GEQUAL,
always: gl.ALWAYS},
test = tests[this.getMaterial(id, "depth_test")];
gl.depthFunc(test);
};
this.mode4type = {points : "POINTS",
linestrip : "LINE_STRIP",
abclines : "LINES",
lines : "LINES",
sprites : "TRIANGLES",
planes : "TRIANGLES",
text : "TRIANGLES",
quads : "TRIANGLES",
surface : "TRIANGLES",
triangles : "TRIANGLES"};
this.drawObj = function(id, subsceneid) {
var obj = this.getObj(id),
subscene = this.getObj(subsceneid),
flags = obj.flags,
type = obj.type,
is_indexed = flags & this.f_is_indexed,
is_lit = flags & this.f_is_lit,
has_texture = flags & this.f_has_texture,
fixed_quads = flags & this.f_fixed_quads,
depth_sort = flags & this.f_depth_sort,
sprites_3d = flags & this.f_sprites_3d,
sprite_3d = flags & this.f_sprite_3d,
is_lines = flags & this.f_is_lines,
is_points = flags & this.f_is_points,
fixed_size = flags & this.f_fixed_size,
is_twosided = (flags & this.f_is_twosided) > 0,
gl = this.gl || this.initGL(),
mat,
sphereMV, baseofs, ofs, sscale, i, count, light,
faces, pass, mode, pmode, attr,
depthsort = function(i,j) { return depths[j] - depths[i]; };
if (typeof id !== "number") {
this.alertOnce("drawObj id is "+typeof id);
}
if (type === "planes") {
if (obj.bbox !== subscene.par3d.bbox || !obj.initialized) {
this.planeUpdateTriangles(id, subscene.par3d.bbox);
}
}
if (!obj.initialized)
this.initObj(id);
if (type === "clipplanes") {
count = obj.offsets.length;
var IMVClip = [];
for (i=0; i < count; i++) {
IMVClip[i] = this.multMV(this.invMatrix, obj.vClipplane.slice(4*i, 4*(i+1)));
}
obj.IMVClip = IMVClip;
return;
}
if (type === "light" || type === "bboxdeco" || !obj.vertexCount)
return;
this.setDepthTest(id);
if (sprites_3d) {
var norigs = obj.vertices.length,
savenorm = new CanvasMatrix4(this.normMatrix);
this.origs = obj.vertices;
this.usermat = new Float32Array(obj.userMatrix.getAsArray());
this.radii = obj.radii;
this.normMatrix = subscene.spriteNormmat;
for (this.iOrig=0; this.iOrig < norigs; this.iOrig++) {
for (i=0; i < obj.objects.length; i++) {
this.drawObj(obj.objects[i], subsceneid);
}
}
this.normMatrix = savenorm;
return;
} else {
gl.useProgram(obj.prog);
}
if (sprite_3d) {
gl.uniform3fv(obj.origLoc, new Float32Array(this.origs[this.iOrig]));
if (this.radii.length > 1) {
gl.uniform1f(obj.sizeLoc, this.radii[this.iOrig][0]);
} else {
gl.uniform1f(obj.sizeLoc, this.radii[0][0]);
}
gl.uniformMatrix4fv(obj.usermatLoc, false, this.usermat);
}
if (type === "spheres") {
gl.bindBuffer(gl.ARRAY_BUFFER, this.sphere.buf);
} else {
gl.bindBuffer(gl.ARRAY_BUFFER, obj.buf);
}
gl.uniformMatrix4fv( obj.prMatLoc, false, new Float32Array(this.prMatrix.getAsArray()) );
gl.uniformMatrix4fv( obj.mvMatLoc, false, new Float32Array(this.mvMatrix.getAsArray()) );
var clipcheck = 0,
clipplaneids = subscene.clipplanes,
clip, j;
for (i=0; i < clipplaneids.length; i++) {
clip = this.getObj(clipplaneids[i]);
for (j=0; j < clip.offsets.length; j++) {
gl.uniform4fv(obj.clipLoc[clipcheck + j], clip.IMVClip[j]);
}
clipcheck += clip.offsets.length;
}
if (typeof obj.clipLoc !== "undefined")
for (i=clipcheck; i < obj.clipLoc.length; i++)
gl.uniform4f(obj.clipLoc[i], 0,0,0,0);
if (is_lit) {
gl.uniformMatrix4fv( obj.normMatLoc, false, new Float32Array(this.normMatrix.getAsArray()) );
gl.uniform3fv( obj.emissionLoc, obj.emission);
gl.uniform1f( obj.shininessLoc, obj.shininess);
for (i=0; i < subscene.lights.length; i++) {
light = this.getObj(subscene.lights[i]);
gl.uniform3fv( obj.ambientLoc[i], this.componentProduct(light.ambient, obj.ambient));
gl.uniform3fv( obj.specularLoc[i], this.componentProduct(light.specular, obj.specular));
gl.uniform3fv( obj.diffuseLoc[i], light.diffuse);
gl.uniform3fv( obj.lightDirLoc[i], light.lightDir);
gl.uniform1i( obj.viewpointLoc[i], light.viewpoint);
gl.uniform1i( obj.finiteLoc[i], light.finite);
}
for (i=subscene.lights.length; i < obj.nlights; i++) {
gl.uniform3f( obj.ambientLoc[i], 0,0,0);
gl.uniform3f( obj.specularLoc[i], 0,0,0);
gl.uniform3f( obj.diffuseLoc[i], 0,0,0);
}
}
if (fixed_size) {
gl.uniform2f( obj.textScaleLoc, 0.75/this.vp.width, 0.75/this.vp.height);
}
gl.enableVertexAttribArray( this.posLoc );
var nc = obj.colorCount;
count = obj.vertexCount;
if (type === "spheres") {
subscene = this.getObj(subsceneid);
var scale = subscene.par3d.scale,
scount = count;
gl.vertexAttribPointer(this.posLoc,  3, gl.FLOAT, false, 4*this.sphere.vOffsets.stride,  0);
gl.enableVertexAttribArray(obj.normLoc );
gl.vertexAttribPointer(obj.normLoc,  3, gl.FLOAT, false, 4*this.sphere.vOffsets.stride,  0);
gl.disableVertexAttribArray( this.colLoc );
var sphereNorm = new CanvasMatrix4();
sphereNorm.scale(scale[0], scale[1], scale[2]);
sphereNorm.multRight(this.normMatrix);
gl.uniformMatrix4fv( obj.normMatLoc, false, new Float32Array(sphereNorm.getAsArray()) );
if (nc == 1) {
gl.vertexAttrib4fv( this.colLoc, new Float32Array(obj.onecolor));
}
if (has_texture) {
gl.enableVertexAttribArray( obj.texLoc );
gl.vertexAttribPointer(obj.texLoc, 2, gl.FLOAT, false, 4*this.sphere.vOffsets.stride, 
4*this.sphere.vOffsets.tofs);
gl.activeTexture(gl.TEXTURE0);
gl.bindTexture(gl.TEXTURE_2D, obj.texture);
gl.uniform1i( obj.sampler, 0);
}
for (i = 0; i < scount; i++) {
sphereMV = new CanvasMatrix4();
if (depth_sort) {
baseofs = faces[i]*obj.vOffsets.stride;
} else {
baseofs = i*obj.vOffsets.stride;
}
ofs = baseofs + obj.vOffsets.radofs;
sscale = obj.values[ofs];
sphereMV.scale(sscale/scale[0], sscale/scale[1], sscale/scale[2]);
sphereMV.translate(obj.values[baseofs],
obj.values[baseofs+1],
obj.values[baseofs+2]);
sphereMV.multRight(this.mvMatrix);
gl.uniformMatrix4fv( obj.mvMatLoc, false, new Float32Array(sphereMV.getAsArray()) );
if (nc > 1) {
ofs = baseofs + obj.vOffsets.cofs;
gl.vertexAttrib4f( this.colLoc, obj.values[ofs],
obj.values[ofs+1],
obj.values[ofs+2],
obj.values[ofs+3] );
}
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.sphere.ibuf);
gl.drawElements(gl.TRIANGLES, this.sphere.sphereCount, gl.UNSIGNED_SHORT, 0);
}
return;
} else {
if (obj.colorCount === 1) {
gl.disableVertexAttribArray( this.colLoc );
gl.vertexAttrib4fv( this.colLoc, new Float32Array(obj.onecolor));
} else {
gl.enableVertexAttribArray( this.colLoc );
gl.vertexAttribPointer(this.colLoc, 4, gl.FLOAT, false, 4*obj.vOffsets.stride, 4*obj.vOffsets.cofs);
}
}
if (is_lit && obj.vOffsets.nofs > 0) {
gl.enableVertexAttribArray( obj.normLoc );
gl.vertexAttribPointer(obj.normLoc, 3, gl.FLOAT, false, 4*obj.vOffsets.stride, 4*obj.vOffsets.nofs);
}
if (has_texture || type === "text") {
gl.enableVertexAttribArray( obj.texLoc );
gl.vertexAttribPointer(obj.texLoc, 2, gl.FLOAT, false, 4*obj.vOffsets.stride, 4*obj.vOffsets.tofs);
gl.activeTexture(gl.TEXTURE0);
gl.bindTexture(gl.TEXTURE_2D, obj.texture);
gl.uniform1i( obj.sampler, 0);
}
if (fixed_quads) {
gl.enableVertexAttribArray( obj.ofsLoc );
gl.vertexAttribPointer(obj.ofsLoc, 2, gl.FLOAT, false, 4*obj.vOffsets.stride, 4*obj.vOffsets.oofs);
}
if (typeof obj.userAttributes !== "undefined") {
for (attr in obj.userAttribSizes) {  // Not all attributes may have been used
gl.enableVertexAttribArray( obj.userAttribLocations[attr] );
gl.vertexAttribPointer( obj.userAttribLocations[attr], obj.userAttribSizes[attr],
gl.FLOAT, false, 4*obj.vOffsets.stride, 4*obj.userAttribOffsets[attr]);
}
}
if (typeof obj.userUniforms !== "undefined") {
for (attr in obj.userUniformLocations) {
var loc = obj.userUniformLocations[attr];
if (loc !== null) {
var uniform = obj.userUniforms[attr];
if (typeof uniform.length === "undefined")
gl.uniform1f(loc, uniform);
else if (typeof uniform[0].length === "undefined") {
uniform = new Float32Array(uniform);
switch(uniform.length) {
case 2: gl.uniform2fv(loc, uniform); break;
case 3: gl.uniform3fv(loc, uniform); break;
case 4: gl.uniform4fv(loc, uniform); break;
default: console.warn("bad uniform length");
}
} else if (uniform.length == 4 && uniform[0].length == 4) 
gl.uniformMatrix4fv(loc, false, new Float32Array(uniform.getAsArray()));
else
console.warn("unsupported uniform matrix");
}
}
}
for (pass = 0; pass < is_twosided + 1; pass++) {
if (type === "triangles" || type === "quads" || type === "surface")
pmode = this.getMaterial(id, (pass === 0) ? "front" : "back");
else pmode = "filled";
if (pmode === "culled")
continue;
mode = this.mode4type[type];      
if (depth_sort && pmode == "filled") {// Don't try depthsorting on wireframe or points
var nfaces = obj.centers.length,
z, w, frowsize;
frowsize = Math.floor(obj.f[pass].length/nfaces);
var depths = new Float32Array(nfaces);
faces = new Array(nfaces);
for(i=0; i<nfaces; i++) {
z = this.prmvMatrix.m13*obj.centers[3*i] +
this.prmvMatrix.m23*obj.centers[3*i+1] +
this.prmvMatrix.m33*obj.centers[3*i+2] +
this.prmvMatrix.m43;
w = this.prmvMatrix.m14*obj.centers[3*i] +
this.prmvMatrix.m24*obj.centers[3*i+1] +
this.prmvMatrix.m34*obj.centers[3*i+2] +
this.prmvMatrix.m44;
depths[i] = z/w;
faces[i] = i;
}
faces.sort(depthsort);
if (type !== "spheres") {
var f = new Uint16Array(obj.f[pass].length);
for (i=0; i<nfaces; i++) {
for (j=0; j<frowsize; j++) {
f[frowsize*i + j] = obj.f[pass][frowsize*faces[i] + j];
}
}
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, obj.ibuf[pass]);
gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, f, gl.DYNAMIC_DRAW);
}
}
if (is_twosided)
gl.uniform1i(obj.frontLoc, pass !== 0);
if (is_indexed && type !== "spheres") {
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, obj.ibuf[pass]);
} else if (type === "spheres") {
//  FIX ME!
} 
if (type === "sprites" || type === "text" || type === "quads") {
count = count * 6/4;
} else if (type === "surface") {
count = obj.f[pass].length;
}
if (is_indexed) {
count = obj.f[pass].length;
if (pmode === "lines") {
mode = "LINES";
is_lines = true;
} else if (pmode === "points") {
mode = "POINTS";
}
}
if (is_lines) {
gl.lineWidth( this.getMaterial(id, "lwd") );
}
gl.vertexAttribPointer(this.posLoc,  3, gl.FLOAT, false, 4*obj.vOffsets.stride,  4*obj.vOffsets.vofs);
if (is_indexed) {
gl.drawElements(gl[mode], count, gl.UNSIGNED_SHORT, 0);
} else {
gl.drawArrays(gl[mode], 0, count);
}
}
};
this.drawBackground = function(id, subsceneid) {
var gl = this.gl || this.initGL(),
obj = this.getObj(id),
bg, i;
if (!obj.initialized)
this.initObj(id);
if (obj.colors.length) {
bg = obj.colors[0];
gl.clearColor(bg[0], bg[1], bg[2], bg[3]);
gl.depthMask(true);
gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);
}
if (typeof obj.quad !== "undefined") {
this.prMatrix.makeIdentity();
this.mvMatrix.makeIdentity();
gl.disable(gl.BLEND);
gl.disable(gl.DEPTH_TEST);
gl.depthMask(false);
for (i=0; i < obj.quad.length; i++)
this.drawObj(obj.quad[i], subsceneid);
}
};
this.drawSubscene = function(subsceneid) {
var gl = this.gl || this.initGL(),
obj = this.getObj(subsceneid),
objects = this.scene.objects,
subids = obj.objects,
subscene_has_faces = false,
subscene_needs_sorting = false,
flags, i;
if (obj.par3d.skipRedraw)
return;
for (i=0; i < subids.length; i++) {
flags = objects[subids[i]].flags;
if (typeof flags !== "undefined") {
subscene_has_faces |= (flags & this.f_is_lit)
& !(flags & this.f_fixed_quads);
subscene_needs_sorting |= (flags & this.f_depth_sort);
}
}
this.setViewport(subsceneid);
if (typeof obj.backgroundId !== "undefined")
this.drawBackground(obj.backgroundId, subsceneid);
if (subids.length) {
this.setprMatrix(subsceneid);
this.setmvMatrix(subsceneid);
if (subscene_has_faces) {
this.setnormMatrix(subsceneid);
if ((obj.flags & this.f_sprites_3d) &&
typeof obj.spriteNormmat === "undefined") {
obj.spriteNormmat = new CanvasMatrix4(this.normMatrix);
}
}
if (subscene_needs_sorting)
this.setprmvMatrix();
gl.enable(gl.DEPTH_TEST);
gl.depthMask(true);
gl.disable(gl.BLEND);
var clipids = obj.clipplanes;
if (typeof clipids === "undefined") {
console.warn("bad clipids");
}
if (clipids.length > 0) {
this.invMatrix = new CanvasMatrix4(this.mvMatrix);
this.invMatrix.invert();
for (i = 0; i < clipids.length; i++)
this.drawObj(clipids[i], subsceneid);
}
subids = obj.opaque;
if (subids.length > 0) {
for (i = 0; i < subids.length; i++) {
this.drawObj(subids[i], subsceneid);
}
}
subids = obj.transparent;
if (subids.length > 0) {
gl.depthMask(false);
gl.blendFuncSeparate(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA,
gl.ONE, gl.ONE);
gl.enable(gl.BLEND);
for (i = 0; i < subids.length; i++) {
this.drawObj(subids[i], subsceneid);
}
}
subids = obj.subscenes;
for (i = 0; i < subids.length; i++) {
this.drawSubscene(subids[i]);
}
}
};
this.relMouseCoords = function(event) {
var totalOffsetX = 0,
totalOffsetY = 0,
currentElement = this.canvas;
do {
totalOffsetX += currentElement.offsetLeft;
totalOffsetY += currentElement.offsetTop;
currentElement = currentElement.offsetParent;
}
while(currentElement);
var canvasX = event.pageX - totalOffsetX,
canvasY = event.pageY - totalOffsetY;
return {x:canvasX, y:canvasY};
};
this.setMouseHandlers = function() {
var self = this, activeSubscene, handler,
handlers = {}, drag = 0;
handlers.rotBase = 0;
this.screenToVector = function(x, y) {
var viewport = this.getObj(activeSubscene).par3d.viewport,
width = viewport.width*this.canvas.width,
height = viewport.height*this.canvas.height,
radius = Math.max(width, height)/2.0,
cx = width/2.0,
cy = height/2.0,
px = (x-cx)/radius,
py = (y-cy)/radius,
plen = Math.sqrt(px*px+py*py);
if (plen > 1.e-6) {
px = px/plen;
py = py/plen;
}
var angle = (Math.SQRT2 - plen)/Math.SQRT2*Math.PI/2,
z = Math.sin(angle),
zlen = Math.sqrt(1.0 - z*z);
px = px * zlen;
py = py * zlen;
return [px, py, z];
};
handlers.trackballdown = function(x,y) {
var activeSub = this.getObj(activeSubscene),
activeModel = this.getObj(this.useid(activeSub.id, "model")),
i, l = activeModel.par3d.listeners;
handlers.rotBase = this.screenToVector(x, y);
this.saveMat = [];
for (i = 0; i < l.length; i++) {
activeSub = this.getObj(l[i]);
activeSub.saveMat = new CanvasMatrix4(activeSub.par3d.userMatrix);
}
};
handlers.trackballmove = function(x,y) {
var rotCurrent = this.screenToVector(x,y),
rotBase = handlers.rotBase,
dot = rotBase[0]*rotCurrent[0] +
rotBase[1]*rotCurrent[1] +
rotBase[2]*rotCurrent[2],
angle = Math.acos( dot/this.vlen(rotBase)/this.vlen(rotCurrent) )*180.0/Math.PI,
axis = this.xprod(rotBase, rotCurrent),
objects = this.scene.objects,
activeSub = this.getObj(activeSubscene),
activeModel = this.getObj(this.useid(activeSub.id, "model")),
l = activeModel.par3d.listeners,
i;
for (i = 0; i < l.length; i++) {
activeSub = this.getObj(l[i]);
activeSub.par3d.userMatrix.load(objects[l[i]].saveMat);
activeSub.par3d.userMatrix.rotate(angle, axis[0], axis[1], axis[2]);
}
this.drawScene();
};
handlers.trackballend = 0;
handlers.axisdown = function(x,y) {
handlers.rotBase = this.screenToVector(x, this.canvas.height/2);
var activeSub = this.getObj(activeSubscene),
activeModel = this.getObj(this.useid(activeSub.id, "model")),
i, l = activeModel.par3d.listeners;
for (i = 0; i < l.length; i++) {
activeSub = this.getObj(l[i]);
activeSub.saveMat = new CanvasMatrix4(activeSub.par3d.userMatrix);
}
};
handlers.axismove = function(x,y) {
var rotCurrent = this.screenToVector(x, this.canvas.height/2),
rotBase = handlers.rotBase,
angle = (rotCurrent[0] - rotBase[0])*180/Math.PI,
rotMat = new CanvasMatrix4();
rotMat.rotate(angle, handlers.axis[0], handlers.axis[1], handlers.axis[2]);
var activeSub = this.getObj(activeSubscene),
activeModel = this.getObj(this.useid(activeSub.id, "model")),
i, l = activeModel.par3d.listeners;
for (i = 0; i < l.length; i++) {
activeSub = this.getObj(l[i]);
activeSub.par3d.userMatrix.load(activeSub.saveMat);
activeSub.par3d.userMatrix.multLeft(rotMat);
}
this.drawScene();
};
handlers.axisend = 0;
handlers.y0zoom = 0;
handlers.zoom0 = 0;
handlers.zoomdown = function(x, y) {
var activeSub = this.getObj(activeSubscene),
activeProjection = this.getObj(this.useid(activeSub.id, "projection")),
i, l = activeProjection.par3d.listeners;
handlers.y0zoom = y;
for (i = 0; i < l.length; i++) {
activeSub = this.getObj(l[i]);
activeSub.zoom0 = Math.log(activeSub.par3d.zoom);
}
};
handlers.zoommove = function(x, y) {
var activeSub = this.getObj(activeSubscene),
activeProjection = this.getObj(this.useid(activeSub.id, "projection")),
i, l = activeProjection.par3d.listeners;
for (i = 0; i < l.length; i++) {
activeSub = this.getObj(l[i]);
activeSub.par3d.zoom = Math.exp(activeSub.zoom0 + (y-handlers.y0zoom)/this.canvas.height);
}
this.drawScene();
};
handlers.zoomend = 0;
handlers.y0fov = 0;
handlers.fovdown = function(x, y) {
handlers.y0fov = y;
var activeSub = this.getObj(activeSubscene),
activeProjection = this.getObj(this.useid(activeSub.id, "projection")),
i, l = activeProjection.par3d.listeners;
for (i = 0; i < l.length; i++) {
activeSub = this.getObj(l[i]);
activeSub.fov0 = activeSub.par3d.FOV;
}
};
handlers.fovmove = function(x, y) {
var activeSub = this.getObj(activeSubscene),
activeProjection = this.getObj(this.useid(activeSub.id, "projection")),
i, l = activeProjection.par3d.listeners;
for (i = 0; i < l.length; i++) {
activeSub = this.getObj(l[i]);
activeSub.par3d.FOV = Math.max(1, Math.min(179, activeSub.fov0 +
180*(y-handlers.y0fov)/this.canvas.height));
}
this.drawScene();
};
handlers.fovend = 0;
this.canvas.onmousedown = function ( ev ){
if (!ev.which) // Use w3c defns in preference to MS
switch (ev.button) {
case 0: ev.which = 1; break;
case 1:
case 4: ev.which = 2; break;
case 2: ev.which = 3;
}
drag = ["left", "middle", "right"][ev.which-1];
var coords = self.relMouseCoords(ev);
coords.y = self.canvas.height-coords.y;
activeSubscene = self.whichSubscene(coords);
var sub = self.getObj(activeSubscene), f;
handler = sub.par3d.mouseMode[drag];
switch (handler) {
case "xAxis":
handler = "axis";
handlers.axis = [1.0, 0.0, 0.0];
break;
case "yAxis":
handler = "axis";
handlers.axis = [0.0, 1.0, 0.0];
break;
case "zAxis":
handler = "axis";
handlers.axis = [0.0, 0.0, 1.0];
break;
}
f = handlers[handler + "down"];
if (f) {
coords = self.translateCoords(activeSubscene, coords);
f.call(self, coords.x, coords.y);
ev.preventDefault();
}
};
this.canvas.onmouseup = function ( ev ){
if ( drag === 0 ) return;
var f = handlers[handler + "up"];
if (f)
f();
drag = 0;
};
this.canvas.onmouseout = this.canvas.onmouseup;
this.canvas.onmousemove = function ( ev ) {
if ( drag === 0 ) return;
var f = handlers[handler + "move"];
if (f) {
var coords = self.relMouseCoords(ev);
coords.y = self.canvas.height - coords.y;
coords = self.translateCoords(activeSubscene, coords);
f.call(self, coords.x, coords.y);
}
};
handlers.wheelHandler = function(ev) {
var del = 1.02, i;
if (ev.shiftKey) del = 1.002;
var ds = ((ev.detail || ev.wheelDelta) > 0) ? del : (1 / del);
if (typeof activeSubscene === "undefined")
activeSubscene = self.scene.rootSubscene;
var activeSub = self.getObj(activeSubscene),
activeProjection = self.getObj(self.useid(activeSub.id, "projection")),
l = activeProjection.par3d.listeners;
for (i = 0; i < l.length; i++) {
activeSub = self.getObj(l[i]);
activeSub.par3d.zoom *= ds;
}
self.drawScene();
ev.preventDefault();
};
this.canvas.addEventListener("DOMMouseScroll", handlers.wheelHandler, false);
this.canvas.addEventListener("mousewheel", handlers.wheelHandler, false);
};
this.useid = function(subsceneid, type) {
var sub = this.getObj(subsceneid);
if (sub.embeddings[type] === "inherit")
return(this.useid(sub.parent, type));
else
return subsceneid;
};
this.inViewport = function(coords, subsceneid) {
var viewport = this.getObj(subsceneid).par3d.viewport,
x0 = coords.x - viewport.x*this.canvas.width,
y0 = coords.y - viewport.y*this.canvas.height;
return 0 <= x0 && x0 <= viewport.width*this.canvas.width &&
0 <= y0 && y0 <= viewport.height*this.canvas.height;
};
this.whichSubscene = function(coords) {
var self = this,
recurse = function(subsceneid) {
var subscenes = self.getChildSubscenes(subsceneid), i, id;
for (i=0; i < subscenes.length; i++) {
id = recurse(subscenes[i]);
if (typeof(id) !== "undefined")
return(id);
}
if (self.inViewport(coords, subsceneid))
return(subsceneid);
else
return undefined;
},
rootid = this.scene.rootSubscene,
result = recurse(rootid);
if (typeof(result) === "undefined")
result = rootid;
return result;
};
this.translateCoords = function(subsceneid, coords) {
var viewport = this.getObj(subsceneid).par3d.viewport;
return {x: coords.x - viewport.x*this.canvas.width,
y: coords.y - viewport.y*this.canvas.height};
};
this.initSphere = function() {
var verts = this.scene.sphereVerts, 
reuse = verts.reuse, result;
if (typeof reuse !== "undefined") {
var prev = document.getElementById(reuse).rglinstance.sphere;
result = {values: prev.values, vOffsets: prev.vOffsets, it: prev.it};
} else 
result = {values: new Float32Array(this.flatten(this.cbind(this.transpose(verts.vb),
this.transpose(verts.texcoords)))),
it: new Uint16Array(this.flatten(this.transpose(verts.it))),
vOffsets: {vofs:0, cofs:-1, nofs:-1, radofs:-1, oofs:-1, 
tofs:3, stride:5}};
result.sphereCount = result.it.length;
this.sphere = result;
};
this.initSphereGL = function() {
var gl = this.gl || this.initGL(), sphere = this.sphere;
if (gl.isContextLost()) return;
sphere.buf = gl.createBuffer();
gl.bindBuffer(gl.ARRAY_BUFFER, sphere.buf);
gl.bufferData(gl.ARRAY_BUFFER, sphere.values, gl.STATIC_DRAW);
sphere.ibuf = gl.createBuffer();
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, sphere.ibuf);
gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, sphere.it, gl.STATIC_DRAW);
return;
};
this.initialize = function(el, x) {
this.textureCanvas = document.createElement("canvas");
this.textureCanvas.style.display = "block";
this.scene = x;
this.normMatrix = new CanvasMatrix4();
this.saveMat = {};
this.distance = null;
this.posLoc = 0;
this.colLoc = 1;
if (el) {
el.rglinstance = this;
this.el = el;
this.webGLoptions = el.rglinstance.scene.webGLoptions;
this.initCanvas();
}
};
this.restartCanvas = function() {
var newcanvas = document.createElement("canvas");
newcanvas.width = this.el.width;
newcanvas.height = this.el.height;
newcanvas.addEventListener("webglcontextrestored",
this.onContextRestored, false);
newcanvas.addEventListener("webglcontextlost",
this.onContextLost, false);            
while (this.el.firstChild) {
this.el.removeChild(this.el.firstChild);
}
this.el.appendChild(newcanvas);
this.canvas = newcanvas;
this.gl = null;         
};
this.initCanvas = function() {
this.restartCanvas();
var objs = this.scene.objects,
self = this;
Object.keys(objs).forEach(function(key){
var id = parseInt(key, 10),
obj = self.getObj(id);
if (typeof obj.reuse !== "undefined")
self.copyObj(id, obj.reuse);
});
Object.keys(objs).forEach(function(key){
self.initSubscene(parseInt(key, 10));
});
this.setMouseHandlers();      
this.initSphere();
this.onContextRestored = function(event) {
self.initGL();
self.drawScene();
// console.log("restored context for "+self.scene.rootSubscene);
};
this.onContextLost = function(event) {
if (!self.drawing)
self.restartCanvas();
event.preventDefault();
};
this.initGL0();
lazyLoadScene = function() {
if (self.isInBrowserViewport()) {
if (!self.gl) {
self.initGL();
}
self.drawScene();
}
};
window.addEventListener("DOMContentLoaded", lazyLoadScene, false);
window.addEventListener("load", lazyLoadScene, false);
window.addEventListener("resize", lazyLoadScene, false);
window.addEventListener("scroll", lazyLoadScene, false);
};
/* this is only used by writeWebGL; rglwidget has
no debug element and does the drawing in rglwidget.js */
this.start = function() {
if (typeof this.prefix !== "undefined") {
this.debugelement = document.getElementById(this.prefix + "debug");
this.debug("");
}
this.drag = 0;
this.drawScene();
};
this.debug = function(msg, img) {
if (typeof this.debugelement !== "undefined" && this.debugelement !== null) {
this.debugelement.innerHTML = msg;
if (typeof img !== "undefined") {
this.debugelement.insertBefore(img, this.debugelement.firstChild);
}
} else if (msg !== "")
alert(msg);
};
this.getSnapshot = function() {
var img;
if (typeof this.scene.snapshot !== "undefined") {
img = document.createElement("img");
img.src = this.scene.snapshot;
img.alt = "Snapshot";
}
return img;
};
this.initGL0 = function() {
if (!window.WebGLRenderingContext){
alert("Your browser does not support WebGL. See http://get.webgl.org");
return;
}
};
this.isInBrowserViewport = function() {
var rect = this.canvas.getBoundingClientRect(),
windHeight = (window.innerHeight || document.documentElement.clientHeight),
windWidth = (window.innerWidth || document.documentElement.clientWidth);
return (
rect.top >= -windHeight &&
rect.left >= -windWidth &&
rect.bottom <= 2*windHeight &&
rect.right <= 2*windWidth);
};
this.initGL = function() {
var self = this;
if (this.gl) {
if (!this.drawing && this.gl.isContextLost())
this.restartCanvas();
else
return this.gl;
}
// if (!this.isInBrowserViewport()) return; Return what??? At this point we know this.gl is null.
this.canvas.addEventListener("webglcontextrestored",
this.onContextRestored, false);
this.canvas.addEventListener("webglcontextlost",
this.onContextLost, false);      
this.gl = this.canvas.getContext("webgl", this.webGLoptions) ||
this.canvas.getContext("experimental-webgl", this.webGLoptions);
var save = this.startDrawing();
this.initSphereGL(); 
Object.keys(this.scene.objects).forEach(function(key){
self.initObj(parseInt(key, 10));
});
this.stopDrawing(save);
return this.gl;
};
this.resize = function(el) {
this.canvas.width = el.width;
this.canvas.height = el.height;
};
this.drawScene = function() {
var gl = this.gl || this.initGL(),
save = this.startDrawing();
gl.enable(gl.DEPTH_TEST);
gl.depthFunc(gl.LEQUAL);
gl.clearDepth(1.0);
gl.clearColor(1,1,1,1);
gl.depthMask(true); // Must be true before clearing depth buffer
gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);
this.drawSubscene(this.scene.rootSubscene);
this.stopDrawing(save);
};
this.subsetSetter = function(el, control) {
if (typeof control.subscenes === "undefined" ||
control.subscenes === null)
control.subscenes = this.scene.rootSubscene;
var value = Math.round(control.value),
subscenes = [].concat(control.subscenes),
fullset = [].concat(control.fullset),
i, j, entries, subsceneid, 
adds = [], deletes = [],
ismissing = function(x) {
return fullset.indexOf(x) < 0;
},
tointeger = function(x) {
return parseInt(x, 10);
};
if (control.accumulate)
for (i=0; i <= value; i++)
adds = adds.concat(control.subsets[i]);
else
adds = adds.concat(control.subsets[value]);
deletes = fullset.filter(function(x) { return adds.indexOf(x) < 0 });  
for (i = 0; i < subscenes.length; i++) {
subsceneid = subscenes[i];
if (typeof this.getObj(subsceneid) === "undefined")
this.alertOnce("typeof object is undefined");
for (j = 0; j < adds.length; j++)
this.addToSubscene(adds[j], subsceneid);
for (j = 0; j < deletes.length; j++)
this.delFromSubscene(deletes[j], subsceneid);
}
};
this.propertySetter = function(el, control)  {
var value = control.value,
values = [].concat(control.values),
svals = [].concat(control.param),
direct = values[0] === null,
entries = [].concat(control.entries),
ncol = entries.length,
nrow = values.length/ncol,
properties = this.repeatToLen(control.properties, ncol),
objids = this.repeatToLen(control.objids, ncol),
property, objid = objids[0],
obj = this.getObj(objid),
propvals, i, v1, v2, p, entry, gl, needsBinding,
newprop, newid,
getPropvals = function() {
if (property === "userMatrix")
return obj.par3d.userMatrix.getAsArray();
else if (property === "scale" || property === "FOV" || property === "zoom")
return [].concat(obj.par3d[property]);
else
return [].concat(obj[property]);
};
putPropvals = function(newvals) {
if (newvals.length == 1)
newvals = newvals[0];
if (property === "userMatrix")
obj.par3d.userMatrix.load(newvals);
else if (property === "scale" || property === "FOV" || property === "zoom")
obj.par3d[property] = newvals;
else
obj[property] = newvals;
}
if (direct && typeof value === "undefined")
return;
if (control.interp) {
values = values.slice(0, ncol).concat(values).
concat(values.slice(ncol*(nrow-1), ncol*nrow));
svals = [-Infinity].concat(svals).concat(Infinity);
for (i = 1; i < svals.length; i++) {
if (value <= svals[i]) {
if (svals[i] === Infinity)
p = 1;
else
p = (svals[i] - value)/(svals[i] - svals[i-1]);
break;
}
}
} else if (!direct) {
value = Math.round(value);
}
for (j=0; j<entries.length; j++) {
entry = entries[j];
newprop = properties[j];
newid = objids[j];
if (newprop !== property || newid != objid) {
if (typeof property !== "undefined")
putPropvals(propvals);
property = newprop;
objid = newid;
obj = this.getObj(objid);
propvals = getPropvals();
}
if (control.interp) {
v1 = values[ncol*(i-1) + j];
v2 = values[ncol*i + j];
this.setElement(propvals, entry, p*v1 + (1-p)*v2);
} else if (!direct) {
this.setElement(propvals, entry, values[ncol*value + j]);
} else {
this.setElement(propvals, entry, value[j]);
}
}
putPropvals(propvals);
needsBinding = [];
for (j=0; j < entries.length; j++) {
if (properties[j] === "values" &&
needsBinding.indexOf(objids[j]) === -1) {
needsBinding.push(objids[j]);
}
}
for (j=0; j < needsBinding.length; j++) {
gl = this.gl || this.initGL();
obj = this.getObj(needsBinding[j]);
gl.bindBuffer(gl.ARRAY_BUFFER, obj.buf);
gl.bufferData(gl.ARRAY_BUFFER, obj.values, gl.STATIC_DRAW);
}
};
this.vertexSetter = function(el, control)  {
var svals = [].concat(control.param),
j, k, p, propvals, stride, ofs, obj,
attrib,
ofss    = {x:"vofs", y:"vofs", z:"vofs",
red:"cofs", green:"cofs", blue:"cofs",
alpha:"cofs", radii:"radofs",
nx:"nofs", ny:"nofs", nz:"nofs",
ox:"oofs", oy:"oofs", oz:"oofs",
ts:"tofs", tt:"tofs"},
pos     = {x:0, y:1, z:2,
red:0, green:1, blue:2,
alpha:3,radii:0,
nx:0, ny:1, nz:2,
ox:0, oy:1, oz:2,
ts:0, tt:1},
values = control.values,
direct = values === null,
ncol,
interp = control.interp,
vertices = [].concat(control.vertices),
attributes = [].concat(control.attributes),
value = control.value;
ncol = Math.max(vertices.length, attributes.length);
if (!ncol)
return;
vertices = this.repeatToLen(vertices, ncol);
attributes = this.repeatToLen(attributes, ncol);
if (direct)
interp = false;
/* JSON doesn't pass Infinity */
svals[0] = -Infinity;
svals[svals.length - 1] = Infinity;
for (j = 1; j < svals.length; j++) {
if (value <= svals[j]) {
if (interp) {
if (svals[j] === Infinity)
p = 1;
else
p = (svals[j] - value)/(svals[j] - svals[j-1]);
} else {
if (svals[j] - value > value - svals[j-1])
j = j - 1;
}
break;
}
}
obj = this.getObj(control.objid);
propvals = obj.values;
for (k=0; k<ncol; k++) {
attrib = attributes[k];
vertex = vertices[k];
ofs = obj.vOffsets[ofss[attrib]];
if (ofs < 0)
this.alertOnce("Attribute '"+attrib+"' not found in object "+control.objid);
else {
stride = obj.vOffsets.stride;
ofs = vertex*stride + ofs + pos[attrib];
if (direct) {
propvals[ofs] = value;
} else if (interp) {
propvals[ofs] = p*values[j-1][k] + (1-p)*values[j][k];
} else {
propvals[ofs] = values[j][k];
}
}
}
if (typeof obj.buf !== "undefined") {
var gl = this.gl || this.initGL();
gl.bindBuffer(gl.ARRAY_BUFFER, obj.buf);
gl.bufferData(gl.ARRAY_BUFFER, propvals, gl.STATIC_DRAW);
}
};
this.ageSetter = function(el, control) {
var objids = [].concat(control.objids),
nobjs = objids.length,
time = control.value,
births = [].concat(control.births),
ages = [].concat(control.ages),
steps = births.length,
j = Array(steps),
p = Array(steps),
i, k, age, j0, propvals, stride, ofs, objid, obj,
attrib, dim,
attribs = ["colors", "alpha", "radii", "vertices",
"normals", "origins", "texcoords",
"x", "y", "z",
"red", "green", "blue"],
ofss    = ["cofs", "cofs", "radofs", "vofs",
"nofs", "oofs", "tofs",
"vofs", "vofs", "vofs",
"cofs", "cofs", "cofs"],
dims    = [3,1,1,3,
3,2,2,
1,1,1,
1,1,1],
pos     = [0,3,0,0,
0,0,0,
0,1,2,
0,1,2];
/* Infinity doesn't make it through JSON */
ages[0] = -Infinity;
ages[ages.length-1] = Infinity;
for (i = 0; i < steps; i++) {
if (births[i] !== null) {  // NA in R becomes null
age = time - births[i];
for (j0 = 1; age > ages[j0]; j0++);
if (ages[j0] == Infinity)
p[i] = 1;
else if (ages[j0] > ages[j0-1])
p[i] = (ages[j0] - age)/(ages[j0] - ages[j0-1]);
else
p[i] = 0;
j[i] = j0;
}
}
for (l = 0; l < nobjs; l++) {
objid = objids[l];
obj = this.getObj(objid);
if (typeof obj.vOffsets === "undefined")
continue;
propvals = obj.values;
stride = obj.vOffsets.stride;
for (k = 0; k < attribs.length; k++) {
attrib = control[attribs[k]];
if (typeof attrib !== "undefined") {
ofs = obj.vOffsets[ofss[k]];
if (ofs >= 0) {
dim = dims[k];
ofs = ofs + pos[k];
for (i = 0; i < steps; i++) {
if (births[i] !== null) {
for (d=0; d < dim; d++) {
propvals[i*stride + ofs + d] = p[i]*attrib[dim*(j[i]-1) + d] + (1-p[i])*attrib[dim*j[i] + d];
}
}
}
} else
this.alertOnce("\'"+attribs[k]+"\' property not found in object "+objid);
}
}
obj.values = propvals;
if (typeof obj.buf !== "undefined") {
gl = this.gl || this.initGL();
gl.bindBuffer(gl.ARRAY_BUFFER, obj.buf);
gl.bufferData(gl.ARRAY_BUFFER, obj.values, gl.STATIC_DRAW);
}
}
};
this.oldBridge = function(el, control) {
var attrname, global = window[control.prefix + "rgl"];
if (typeof global !== "undefined")
for (attrname in global)
this[attrname] = global[attrname];
window[control.prefix + "rgl"] = this;
};
this.Player = function(el, control) {
var
self = this,
components = [].concat(control.components),
buttonLabels = [].concat(control.buttonLabels),
Tick = function() { /* "this" will be a timer */
var i,
nominal = this.value,
slider = this.Slider,
labels = this.outputLabels,
output = this.Output,
step;
if (typeof slider !== "undefined" && nominal != slider.value)
slider.value = nominal;
if (typeof output !== "undefined") {
step = Math.round((nominal - output.sliderMin)/output.sliderStep);
if (labels !== null) {
output.innerHTML = labels[step];
} else {
step = step*output.sliderStep + output.sliderMin;
output.innerHTML = step.toPrecision(output.outputPrecision);
}
}
for (i=0; i < this.actions.length; i++) {
this.actions[i].value = nominal;
}
self.applyControls(el, this.actions, false);
self.drawScene();
},
OnSliderInput = function() { /* "this" will be the slider */
this.rgltimer.value = Number(this.value);
this.rgltimer.Tick();
},
addSlider = function(min, max, step, value) {
var slider = document.createElement("input");
slider.type = "range";
slider.min = min;
slider.max = max;
slider.step = step;
slider.value = value;
slider.oninput = OnSliderInput;
slider.sliderActions = control.actions;
slider.sliderScene = this;
slider.className = "rgl-slider";
slider.id = el.id + "-slider";
el.rgltimer.Slider = slider;
slider.rgltimer = el.rgltimer;
el.appendChild(slider);
},
addLabel = function(labels, min, step, precision) {
var output = document.createElement("output");
output.sliderMin = min;
output.sliderStep = step;
output.outputPrecision = precision;
output.className = "rgl-label";
output.id = el.id + "-label";
el.rgltimer.Output = output;
el.rgltimer.outputLabels = labels;
el.appendChild(output);
},
addButton = function(which, label, active) {
var button = document.createElement("input"),
onclicks = {Reverse: function() { this.rgltimer.reverse();},
Play: function() { this.rgltimer.play();
this.value = this.rgltimer.enabled ? this.inactiveValue : this.activeValue; },
Slower: function() { this.rgltimer.slower(); },
Faster: function() { this.rgltimer.faster(); },
Reset: function() { this.rgltimer.reset(); },
Step:  function() { this.rgltimer.step(); }
};
button.rgltimer = el.rgltimer;
button.type = "button";
button.value = label;
button.activeValue = label;
button.inactiveValue = active;
if (which === "Play")
button.rgltimer.PlayButton = button;
button.onclick = onclicks[which];
button.className = "rgl-button";
button.id = el.id + "-" + which;
el.appendChild(button);
};
if (typeof control.reinit !== "undefined" && control.reinit !== null) {
control.actions.reinit = control.reinit;
}
el.rgltimer = new rgltimerClass(Tick, control.start, control.interval, control.stop, 
control.step, control.value, control.rate, control.loop, control.actions);
for (var i=0; i < components.length; i++) {
switch(components[i]) {
case "Slider": addSlider(control.start, control.stop,
control.step, control.value);
break;
case "Label": addLabel(control.labels, control.start,
control.step, control.precision);
break;
default:
addButton(components[i], buttonLabels[i], control.pause);
}
}
el.rgltimer.Tick();
};
this.applyControls = function(el, x, draw) {
var self = this, reinit = x.reinit, i, control, type;
for (i = 0; i < x.length; i++) {
control = x[i];
type = control.type;
self[type](el, control);
}
if (typeof reinit !== "undefined" && reinit !== null) {
reinit = [].concat(reinit);
for (i = 0; i < reinit.length; i++)
self.getObj(reinit[i]).initialized = false;
}
if (typeof draw === "undefined" || draw)
self.drawScene();
};
this.sceneChangeHandler = function(message) {
var self = document.getElementById(message.elementId).rglinstance,
objs = message.objects, mat = message.material,
root = message.rootSubscene,
initSubs = message.initSubscenes,
redraw = message.redrawScene,
skipRedraw = message.skipRedraw,
deletes, subs, allsubs = [], i,j;
if (typeof message.delete !== "undefined") {
deletes = [].concat(message.delete);
if (typeof message.delfromSubscenes !== "undefined")
subs = [].concat(message.delfromSubscenes);
else
subs = [];
for (i = 0; i < deletes.length; i++) {
for (j = 0; j < subs.length; j++) {
self.delFromSubscene(deletes[i], subs[j]);
}
delete self.scene.objects[deletes[i]];
}
}
if (typeof objs !== "undefined") {
Object.keys(objs).forEach(function(key){
key = parseInt(key, 10);
self.scene.objects[key] = objs[key];
self.initObj(key);
var obj = self.getObj(key),
subs = [].concat(obj.inSubscenes), k;
allsubs = allsubs.concat(subs);
for (k = 0; k < subs.length; k++)
self.addToSubscene(key, subs[k]);
});
}
if (typeof mat !== "undefined") {
self.scene.material = mat;
}
if (typeof root !== "undefined") {
self.scene.rootSubscene = root;
}
if (typeof initSubs !== "undefined")
allsubs = allsubs.concat(initSubs);
allsubs = self.unique(allsubs);
for (i = 0; i < allsubs.length; i++) {
self.initSubscene(allsubs[i]);
}
if (typeof skipRedraw !== "undefined") {
root = self.getObj(self.scene.rootSubscene);
root.par3d.skipRedraw = skipRedraw;
}
if (redraw)
self.drawScene();
};
}).call(rglwidgetClass.prototype);
rgltimerClass = function(Tick, startTime, interval, stopTime, stepSize, value, rate, loop, actions) {
this.enabled = false;
this.timerId = 0;
this.startTime = startTime;         /* nominal start time in seconds */
this.value = value;                 /* current nominal time */
this.interval = interval;           /* seconds between updates */
this.stopTime = stopTime;           /* nominal stop time */
this.stepSize = stepSize;           /* nominal step size */
this.rate = rate;                   /* nominal units per second */
this.loop = loop;                   /* "none", "cycle", or "oscillate" */
this.realStart = undefined;         /* real world start time */
this.multiplier = 1;                /* multiplier for fast-forward
or reverse */
this.actions = actions;
this.Tick = Tick;
};
(function() {
this.play = function() {
if (this.enabled) {
this.enabled = false;
window.clearInterval(this.timerId);
this.timerId = 0;
return;
}
var tick = function(self) {
var now = new Date();
self.value = self.multiplier*self.rate*(now - self.realStart)/1000 + self.startTime;
self.forceToRange();
if (typeof self.Tick !== "undefined") {
self.Tick(self.value);
}
};
this.realStart = new Date() - 1000*(this.value - this.startTime)/this.rate/this.multiplier;
this.timerId = window.setInterval(tick, 1000*this.interval, this);
this.enabled = true;
};
this.forceToRange = function() {
if (this.value > this.stopTime + this.stepSize/2 || this.value < this.startTime - this.stepSize/2) {
if (!this.loop) {
this.reset();
} else {
var cycle = this.stopTime - this.startTime + this.stepSize,
newval = (this.value - this.startTime) % cycle + this.startTime;
if (newval < this.startTime) {
newval += cycle;
}
this.realStart += (this.value - newval)*1000/this.multiplier/this.rate;
this.value = newval;
}
}   
}
this.reset = function() {
this.value = this.startTime;
this.newmultiplier(1);
if (typeof this.Tick !== "undefined") {
this.Tick(this.value);
}
if (this.enabled)
this.play();  /* really pause... */
if (typeof this.PlayButton !== "undefined")
this.PlayButton.value = "Play";
};
this.faster = function() {
this.newmultiplier(Math.SQRT2*this.multiplier);
};
this.slower = function() {
this.newmultiplier(this.multiplier/Math.SQRT2);
};
this.reverse = function() {
this.newmultiplier(-this.multiplier);
};
this.newmultiplier = function(newmult) {
if (newmult != this.multiplier) {
this.realStart += 1000*(this.value - this.startTime)/this.rate*(1/this.multiplier - 1/newmult);
this.multiplier = newmult;
}
};
this.step = function() {
this.value += this.rate*this.multiplier;
this.forceToRange();
if (typeof this.Tick !== "undefined")
this.Tick(this.value);
}
}).call(rgltimerClass.prototype);</script>
<div id="unnamed_chunk_31div" class="rglWebGL"></div>
<script type="text/javascript">
var unnamed_chunk_31div = document.getElementById("unnamed_chunk_31div"),
unnamed_chunk_31rgl = new rglwidgetClass();
unnamed_chunk_31div.width = 361;
unnamed_chunk_31div.height = 505;
unnamed_chunk_31rgl.initialize(unnamed_chunk_31div,
{"material":{"color":"#000000","alpha":1,"lit":true,"ambient":"#000000","specular":"#FFFFFF","emission":"#000000","shininess":50,"smooth":true,"front":"filled","back":"filled","size":3,"lwd":1,"fog":false,"point_antialias":false,"line_antialias":false,"texture":null,"textype":"rgb","texmipmap":false,"texminfilter":"linear","texmagfilter":"linear","texenvmap":false,"depth_mask":true,"depth_test":"less","isTransparent":false},"rootSubscene":1,"objects":{"7":{"id":7,"type":"points","material":{"lit":false},"vertices":[[220.9866,100.987,146.3576],[228.4481,95.44614,144.9361],[227.5289,92.07558,147.0858],[250.5839,96.9143,138.6074],[250.3745,94.33936,137.6201],[263.8074,99.70576,122.8171],[266.2673,100.0974,118.3295],[266.7557,99.18455,116.4301],[272.032,104.9731,104.8673],[272.2923,104.1843,102.9673],[274.8044,102.8469,103.3135],[277.783,103.3639,103.3511],[272.7486,105.5809,104.1977],[278.9789,101.7888,99.9845],[278.7739,109.3905,104.3793],[282.1498,110.0038,105.4512],[224.7067,109.8636,153.5875],[229.6343,92.30637,157.297],[226.8855,90.36325,147.596],[249.8864,93.59079,136.778],[253.0099,90.94904,137.3492],[264.0801,98.5339,121.8946],[266.3223,98.73241,116.4656],[267.546,98.59859,112.8561],[271.0762,102.6729,100.8495],[274.6128,100.9206,103.2877],[277.392,102.1915,102.6947],[287.1214,101.4336,103.3074],[281.7958,96.63987,101.0807],[276.6551,95.09809,99.22113],[278.3287,113.7563,104.877],[282.3069,111.9321,105.6549],[289.5364,111.9601,109.1828],[186.866,132.7093,88.20393]],"colors":[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[0,0,1,1],[0,0,1,1],[0,0,1,1],[0,0,1,1],[0,0,1,1],[0,0,1,1],[0,0,1,1],[0,0,1,1],[0,0,1,1],[0,0,1,1],[0,0,1,1],[0,0,1,1],[0,0,1,1],[0,0,1,1],[0,0,1,1],[0,0,1,1],[0,0,1,1],[0.627451,0.1254902,0.9411765,1]],"centers":[[220.9866,100.987,146.3576],[228.4481,95.44614,144.9361],[227.5289,92.07558,147.0858],[250.5839,96.9143,138.6074],[250.3745,94.33936,137.6201],[263.8074,99.70576,122.8171],[266.2673,100.0974,118.3295],[266.7557,99.18455,116.4301],[272.032,104.9731,104.8673],[272.2923,104.1843,102.9673],[274.8044,102.8469,103.3135],[277.783,103.3639,103.3511],[272.7486,105.5809,104.1977],[278.9789,101.7888,99.9845],[278.7739,109.3905,104.3793],[282.1498,110.0038,105.4512],[224.7067,109.8636,153.5875],[229.6343,92.30637,157.297],[226.8855,90.36325,147.596],[249.8864,93.59079,136.778],[253.0099,90.94904,137.3492],[264.0801,98.5339,121.8946],[266.3223,98.73241,116.4656],[267.546,98.59859,112.8561],[271.0762,102.6729,100.8495],[274.6128,100.9206,103.2877],[277.392,102.1915,102.6947],[287.1214,101.4336,103.3074],[281.7958,96.63987,101.0807],[276.6551,95.09809,99.22113],[278.3287,113.7563,104.877],[282.3069,111.9321,105.6549],[289.5364,111.9601,109.1828],[186.866,132.7093,88.20393]],"ignoreExtent":false,"flags":8192},"8":{"id":8,"type":"linestrip","material":{"lit":false},"vertices":[[186.866,132.7093,88.20393],[187.3355,131.1558,90.5968],[188.1165,130.2545,93.14326],[188.468,129.4757,94.97399],[188.2875,128.7542,97.45621],[188.2733,127.9567,99.16801],[188.4558,127.5704,101.5399],[188.9997,127.5399,103.6954],[189.6382,126.6176,104.954],[189.4185,126.1251,108.0766],[189.5984,125.0614,110.217],[190.1781,124.265,111.8775],[190.728,123.4797,113.6305],[190.9936,122.4563,116.2186],[191.1667,121.1412,118.8179],[191.5731,119.0004,121.6289],[192.2712,116.6221,122.8149],[193.0531,115.1163,125.2636],[194.7689,112.9951,128.0493],[195.9117,112.0142,129.4556],[197.1637,111.6175,131.9181],[198.8203,110.2031,133.3065],[199.9801,108.9401,134.3335],[201.4145,108.1221,136.2538],[202.6894,106.6835,136.0457],[205.341,105.6548,137.2315],[208.0497,104.1643,138.9636],[210.586,102.2778,140.5946],[212.5955,101.9351,143.8587],[215.2199,101.8055,144.2791],[217.4774,101.5081,144.3987],[219.168,101.1618,144.4411],[220.366,100.9909,145.3908],[220.9866,100.987,146.3576],["NaN","NaN","NaN"],[220.9866,100.987,146.3576],[221.8293,101.904,147.2064],[223.2953,103.0118,147.0665],[223.8867,104.3072,147.7834],[224.1486,105.1972,148.4997],[224.4773,106.7239,148.9979],[224.7513,108.0123,149.5417],[224.7584,109.0593,151.0719],[224.7067,109.8636,153.5875],["NaN","NaN","NaN"],[220.9866,100.987,146.3576],[222.1171,100.4789,145.4852],[223.4458,99.71291,145.6201],[225.1521,98.64415,144.8219],[225.7485,97.82787,144.8838],[227.328,96.536,144.9335],[228.4481,95.44614,144.9361],["NaN","NaN","NaN"],[228.4481,95.44614,144.9361],[228.3931,93.87876,145.0145],[227.9172,92.57701,146.1141],[227.5289,92.07558,147.0858],["NaN","NaN","NaN"],[227.5289,92.07558,147.0858],[228.1281,91.81482,146.9982],[228.6721,91.69865,147.8739],[229.1805,91.68178,148.7401],[228.6041,92.68944,152.5703],[228.843,92.8712,153.4464],[229.1483,92.56224,154.1649],[229.059,92.37194,156.5281],[229.6343,92.30637,157.297],["NaN","NaN","NaN"],[227.5289,92.07558,147.0858],[227.412,91.49557,146.982],[227.1017,91.09334,147.7889],[226.8855,90.36325,147.596],["NaN","NaN","NaN"],[228.4481,95.44614,144.9361],[231.0242,95.31286,144.8492],[232.3152,94.80954,144.8533],[234.1503,94.19541,144.0023],[235.5957,94.06973,144.0858],[237.8952,94.37737,143.305],[238.8612,94.80431,143.307],[239.9644,94.7758,142.4694],[241.3587,95.06895,141.6749],[243.9267,95.56536,140.2738],[246.2103,96.29207,139.034],[247.157,96.62735,138.4089],[248.542,96.75484,138.5082],[250.5839,96.9143,138.6074],["NaN","NaN","NaN"],[250.5839,96.9143,138.6074],[250.4272,95.98822,138.5313],[250.2206,95.00672,138.4405],[250.3745,94.33936,137.6201],["NaN","NaN","NaN"],[250.3745,94.33936,137.6201],[249.9186,94.05761,137.5855],[249.8864,93.59079,136.778],["NaN","NaN","NaN"],[250.3745,94.33936,137.6201],[250.7898,93.72993,137.5932],[251.1502,92.9019,137.5457],[251.7909,91.71586,137.4462],[252.5904,91.09129,137.3698],[253.0099,90.94904,137.3492],["NaN","NaN","NaN"],[250.5839,96.9143,138.6074],[252.0321,97.33591,138.6274],[253.2899,97.58426,137.76],[254.7626,97.8494,136.7945],[256.0359,98.47311,135.7194],[257.7767,99.34311,134.4333],[259.1145,100.36,134.0954],[260.3564,100.7826,132.792],[261.7495,100.9496,129.3055],[262.4966,100.3415,127.2079],[263.8074,99.70576,122.8171],["NaN","NaN","NaN"],[263.8074,99.70576,122.8171],[264.0801,98.5339,121.8946],["NaN","NaN","NaN"],[263.8074,99.70576,122.8171],[265.1373,100.227,120.4506],[266.2673,100.0974,118.3295],["NaN","NaN","NaN"],[266.2673,100.0974,118.3295],[266.7557,99.18455,116.4301],["NaN","NaN","NaN"],[266.7557,99.18455,116.4301],[266.3223,98.73241,116.4656],["NaN","NaN","NaN"],[266.7557,99.18455,116.4301],[267.2516,98.61651,112.853],[267.546,98.59859,112.8561],["NaN","NaN","NaN"],[266.2673,100.0974,118.3295],[267.8407,100.284,113.6377],[268.5302,101.2489,110.4057],[269.1459,102.6101,108.2586],[270.2014,104.1951,106.2789],[271.0768,104.9522,106.2173],[272.032,104.9731,104.8673],["NaN","NaN","NaN"],[272.032,104.9731,104.8673],[272.2923,104.1843,102.9673],["NaN","NaN","NaN"],[272.2923,104.1843,102.9673],[271.5912,103.5824,103.0344],[271.1117,102.9115,101.9248],[271.0762,102.6729,100.8495],["NaN","NaN","NaN"],[272.2923,104.1843,102.9673],[272.8246,103.8287,104.7537],[273.6577,103.4428,104.0345],[274.8044,102.8469,103.3135],["NaN","NaN","NaN"],[274.8044,102.8469,103.3135],[274.7829,101.7907,103.2918],[274.6128,100.9206,103.2877],["NaN","NaN","NaN"],[274.8044,102.8469,103.3135],[275.8587,103.0875,103.294],[277.783,103.3639,103.3511],["NaN","NaN","NaN"],[277.783,103.3639,103.3511],[277.6615,102.721,103.3308],[277.392,102.1915,102.6947],["NaN","NaN","NaN"],[277.783,103.3639,103.3511],[278.595,103.4609,103.4094],[279.563,103.6426,103.5104],[280.5097,104.0509,103.0457],[281.4014,104.6174,103.1989],[282.0585,104.9431,103.9054],[283.2689,104.9636,104.1276],[284.4193,104.2881,103.7481],[285.1795,103.7343,102.7591],[285.8599,103.4765,102.9102],[286.4616,103.0286,103.6455],[286.8797,102.6475,103.7644],[287.0918,102.0288,103.2655],[287.1214,101.4336,103.3074],["NaN","NaN","NaN"],[272.032,104.9731,104.8673],[272.7486,105.5809,104.1977],["NaN","NaN","NaN"],[272.7486,105.5809,104.1977],[273.3673,106.4848,102.9745],[274.6024,106.7613,102.3191],[275.4419,106.1793,101.6652],[276.2544,106.0721,101.0881],[276.774,105.311,101.6091],[277.4392,104.2161,101.0135],[278.09,103.4409,101.0319],[278.9789,101.7888,99.9845],["NaN","NaN","NaN"],[278.9789,101.7888,99.9845],[279.8912,100.9907,99.55326],[280.5293,100.0932,100.1923],[281.1848,99.09615,101.4213],[281.6648,97.49535,101.0133],[281.7958,96.63987,101.0807],["NaN","NaN","NaN"],[278.9789,101.7888,99.9845],[278.3321,100.1545,98.81785],[277.7251,99.09983,98.76931],[277.4498,98.20747,98.74865],[277.0392,97.1171,99.26762],[277.0078,95.74657,99.24362],[276.6551,95.09809,99.22113],["NaN","NaN","NaN"],[272.7486,105.5809,104.1977],[273.9125,106.1373,102.9045],[274.762,107.0453,102.9158],[276.1546,107.9018,103.5491],[277.2304,108.2857,104.198],[278.2249,109.0334,104.3084],[278.7739,109.3905,104.3793],["NaN","NaN","NaN"],[278.7739,109.3905,104.3793],[278.7235,110.4274,103.9013],[278.4662,111.5342,104.5861],[278.113,112.6423,104.7063],[278.0377,113.3694,104.8016],[278.3287,113.7563,104.877],["NaN","NaN","NaN"],[278.7739,109.3905,104.3793],[279.69,109.3976,104.4651],[280.6721,109.5932,104.5958],[281.5898,109.8331,105.3493],[282.1498,110.0038,105.4512],["NaN","NaN","NaN"],[282.1498,110.0038,105.4512],[282.1288,110.7525,105.5135],[282.2892,111.4906,105.6074],[282.3069,111.9321,105.6549],["NaN","NaN","NaN"],[282.1498,110.0038,105.4512],[282.8857,109.9996,105.5739],[284.0089,109.7155,106.3845],[284.9341,109.5795,107.1947],[285.779,109.8077,108.0141],[286.976,109.9177,108.2203],[288.1162,110.6115,109.0588],[288.5916,110.9776,108.4278],[289.5364,111.9601,109.1828],["NaN","NaN","NaN"]],"colors":[[1,0,0,1]],"centers":[[186.866,132.7093,88.20393],[187.3355,131.1558,90.5968],[188.1165,130.2545,93.14326],[188.468,129.4757,94.97399],[188.2875,128.7542,97.45621],[188.2733,127.9567,99.16801],[188.4558,127.5704,101.5399],[188.9997,127.5399,103.6954],[189.6382,126.6176,104.954],[189.4185,126.1251,108.0766],[189.5984,125.0614,110.217],[190.1781,124.265,111.8775],[190.728,123.4797,113.6305],[190.9936,122.4563,116.2186],[191.1667,121.1412,118.8179],[191.5731,119.0004,121.6289],[192.2712,116.6221,122.8149],[193.0531,115.1163,125.2636],[194.7689,112.9951,128.0493],[195.9117,112.0142,129.4556],[197.1637,111.6175,131.9181],[198.8203,110.2031,133.3065],[199.9801,108.9401,134.3335],[201.4145,108.1221,136.2538],[202.6894,106.6835,136.0457],[205.341,105.6548,137.2315],[208.0497,104.1643,138.9636],[210.586,102.2778,140.5946],[212.5955,101.9351,143.8587],[215.2199,101.8055,144.2791],[217.4774,101.5081,144.3987],[219.168,101.1618,144.4411],[220.366,100.9909,145.3908],[220.9866,100.987,146.3576],["NaN","NaN","NaN"],[220.9866,100.987,146.3576],[221.8293,101.904,147.2064],[223.2953,103.0118,147.0665],[223.8867,104.3072,147.7834],[224.1486,105.1972,148.4997],[224.4773,106.7239,148.9979],[224.7513,108.0123,149.5417],[224.7584,109.0593,151.0719],[224.7067,109.8636,153.5875],["NaN","NaN","NaN"],[220.9866,100.987,146.3576],[222.1171,100.4789,145.4852],[223.4458,99.71291,145.6201],[225.1521,98.64415,144.8219],[225.7485,97.82787,144.8838],[227.328,96.536,144.9335],[228.4481,95.44614,144.9361],["NaN","NaN","NaN"],[228.4481,95.44614,144.9361],[228.3931,93.87876,145.0145],[227.9172,92.57701,146.1141],[227.5289,92.07558,147.0858],["NaN","NaN","NaN"],[227.5289,92.07558,147.0858],[228.1281,91.81482,146.9982],[228.6721,91.69865,147.8739],[229.1805,91.68178,148.7401],[228.6041,92.68944,152.5703],[228.843,92.8712,153.4464],[229.1483,92.56224,154.1649],[229.059,92.37194,156.5281],[229.6343,92.30637,157.297],["NaN","NaN","NaN"],[227.5289,92.07558,147.0858],[227.412,91.49557,146.982],[227.1017,91.09334,147.7889],[226.8855,90.36325,147.596],["NaN","NaN","NaN"],[228.4481,95.44614,144.9361],[231.0242,95.31286,144.8492],[232.3152,94.80954,144.8533],[234.1503,94.19541,144.0023],[235.5957,94.06973,144.0858],[237.8952,94.37737,143.305],[238.8612,94.80431,143.307],[239.9644,94.7758,142.4694],[241.3587,95.06895,141.6749],[243.9267,95.56536,140.2738],[246.2103,96.29207,139.034],[247.157,96.62735,138.4089],[248.542,96.75484,138.5082],[250.5839,96.9143,138.6074],["NaN","NaN","NaN"],[250.5839,96.9143,138.6074],[250.4272,95.98822,138.5313],[250.2206,95.00672,138.4405],[250.3745,94.33936,137.6201],["NaN","NaN","NaN"],[250.3745,94.33936,137.6201],[249.9186,94.05761,137.5855],[249.8864,93.59079,136.778],["NaN","NaN","NaN"],[250.3745,94.33936,137.6201],[250.7898,93.72993,137.5932],[251.1502,92.9019,137.5457],[251.7909,91.71586,137.4462],[252.5904,91.09129,137.3698],[253.0099,90.94904,137.3492],["NaN","NaN","NaN"],[250.5839,96.9143,138.6074],[252.0321,97.33591,138.6274],[253.2899,97.58426,137.76],[254.7626,97.8494,136.7945],[256.0359,98.47311,135.7194],[257.7767,99.34311,134.4333],[259.1145,100.36,134.0954],[260.3564,100.7826,132.792],[261.7495,100.9496,129.3055],[262.4966,100.3415,127.2079],[263.8074,99.70576,122.8171],["NaN","NaN","NaN"],[263.8074,99.70576,122.8171],[264.0801,98.5339,121.8946],["NaN","NaN","NaN"],[263.8074,99.70576,122.8171],[265.1373,100.227,120.4506],[266.2673,100.0974,118.3295],["NaN","NaN","NaN"],[266.2673,100.0974,118.3295],[266.7557,99.18455,116.4301],["NaN","NaN","NaN"],[266.7557,99.18455,116.4301],[266.3223,98.73241,116.4656],["NaN","NaN","NaN"],[266.7557,99.18455,116.4301],[267.2516,98.61651,112.853],[267.546,98.59859,112.8561],["NaN","NaN","NaN"],[266.2673,100.0974,118.3295],[267.8407,100.284,113.6377],[268.5302,101.2489,110.4057],[269.1459,102.6101,108.2586],[270.2014,104.1951,106.2789],[271.0768,104.9522,106.2173],[272.032,104.9731,104.8673],["NaN","NaN","NaN"],[272.032,104.9731,104.8673],[272.2923,104.1843,102.9673],["NaN","NaN","NaN"],[272.2923,104.1843,102.9673],[271.5912,103.5824,103.0344],[271.1117,102.9115,101.9248],[271.0762,102.6729,100.8495],["NaN","NaN","NaN"],[272.2923,104.1843,102.9673],[272.8246,103.8287,104.7537],[273.6577,103.4428,104.0345],[274.8044,102.8469,103.3135],["NaN","NaN","NaN"],[274.8044,102.8469,103.3135],[274.7829,101.7907,103.2918],[274.6128,100.9206,103.2877],["NaN","NaN","NaN"],[274.8044,102.8469,103.3135],[275.8587,103.0875,103.294],[277.783,103.3639,103.3511],["NaN","NaN","NaN"],[277.783,103.3639,103.3511],[277.6615,102.721,103.3308],[277.392,102.1915,102.6947],["NaN","NaN","NaN"],[277.783,103.3639,103.3511],[278.595,103.4609,103.4094],[279.563,103.6426,103.5104],[280.5097,104.0509,103.0457],[281.4014,104.6174,103.1989],[282.0585,104.9431,103.9054],[283.2689,104.9636,104.1276],[284.4193,104.2881,103.7481],[285.1795,103.7343,102.7591],[285.8599,103.4765,102.9102],[286.4616,103.0286,103.6455],[286.8797,102.6475,103.7644],[287.0918,102.0288,103.2655],[287.1214,101.4336,103.3074],["NaN","NaN","NaN"],[272.032,104.9731,104.8673],[272.7486,105.5809,104.1977],["NaN","NaN","NaN"],[272.7486,105.5809,104.1977],[273.3673,106.4848,102.9745],[274.6024,106.7613,102.3191],[275.4419,106.1793,101.6652],[276.2544,106.0721,101.0881],[276.774,105.311,101.6091],[277.4392,104.2161,101.0135],[278.09,103.4409,101.0319],[278.9789,101.7888,99.9845],["NaN","NaN","NaN"],[278.9789,101.7888,99.9845],[279.8912,100.9907,99.55326],[280.5293,100.0932,100.1923],[281.1848,99.09615,101.4213],[281.6648,97.49535,101.0133],[281.7958,96.63987,101.0807],["NaN","NaN","NaN"],[278.9789,101.7888,99.9845],[278.3321,100.1545,98.81785],[277.7251,99.09983,98.76931],[277.4498,98.20747,98.74865],[277.0392,97.1171,99.26762],[277.0078,95.74657,99.24362],[276.6551,95.09809,99.22113],["NaN","NaN","NaN"],[272.7486,105.5809,104.1977],[273.9125,106.1373,102.9045],[274.762,107.0453,102.9158],[276.1546,107.9018,103.5491],[277.2304,108.2857,104.198],[278.2249,109.0334,104.3084],[278.7739,109.3905,104.3793],["NaN","NaN","NaN"],[278.7739,109.3905,104.3793],[278.7235,110.4274,103.9013],[278.4662,111.5342,104.5861],[278.113,112.6423,104.7063],[278.0377,113.3694,104.8016],[278.3287,113.7563,104.877],["NaN","NaN","NaN"],[278.7739,109.3905,104.3793],[279.69,109.3976,104.4651],[280.6721,109.5932,104.5958],[281.5898,109.8331,105.3493],[282.1498,110.0038,105.4512],["NaN","NaN","NaN"],[282.1498,110.0038,105.4512],[282.1288,110.7525,105.5135],[282.2892,111.4906,105.6074],[282.3069,111.9321,105.6549],["NaN","NaN","NaN"],[282.1498,110.0038,105.4512],[282.8857,109.9996,105.5739],[284.0089,109.7155,106.3845],[284.9341,109.5795,107.1947],[285.779,109.8077,108.0141],[286.976,109.9177,108.2203],[288.1162,110.6115,109.0588],[288.5916,110.9776,108.4278],[289.5364,111.9601,109.1828],["NaN","NaN","NaN"]],"ignoreExtent":false,"flags":128},"5":{"id":5,"type":"light","vertices":[[0,0,1]],"colors":[[1,1,1,1],[1,1,1,1],[1,1,1,1]],"viewpoint":true,"finite":false},"4":{"id":4,"type":"background","material":{"fog":true},"colors":[[0.2980392,0.2980392,0.2980392,1]],"centers":[[0,0,0]],"sphere":false,"fogtype":"none","flags":0},"6":{"id":6,"type":"background","material":{"lit":false,"back":"lines"},"colors":[[1,1,1,1]],"centers":[[0,0,0]],"sphere":false,"fogtype":"none","flags":0},"9":{"id":9,"type":"background","material":{"lit":false,"back":"lines"},"colors":[[0.827451,0.827451,0.827451,1]],"centers":[[0,0,0]],"sphere":false,"fogtype":"none","flags":0},"1":{"id":1,"type":"subscene","par3d":{"antialias":0,"FOV":30,"ignoreExtent":false,"listeners":1,"mouseMode":{"left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,252.6833],"modelMatrix":[[1,0,0,-238.2012],[0,0.3420202,0.9396926,-153.4954],[0,-0.9396926,0.3420202,-189.8566],[0,0,0,1]],"projMatrix":[[3.732051,0,0,0],[0,2.665751,0,0],[0,0,-3.863704,-910.8941],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,0.3420201,0.9396926,0],[0,-0.9396926,0.3420201,0],[0,0,0,1]],"scale":[1,1,1],"viewport":{"x":0,"y":0,"width":1,"height":1},"zoom":1,"bbox":[186.866,289.5364,90.36325,132.7093,88.20393,157.297],"windowRect":[100,100,460,604],"family":"sans","font":1,"cex":1,"useFreeType":false,"fontname":"TT Arial","maxClipPlanes":6,"glVersion":1.1},"embeddings":{"viewport":"replace","projection":"replace","model":"replace"},"objects":[9,7,8,5],"subscenes":[],"flags":9344}},"snapshot":"data:image/png;base64,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","width":361,"height":505,"sphereVerts":{"vb":[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.07465783,0.1464466,0.2126075,0.2705981,0.3181896,0.3535534,0.3753303,0.3826834,0.3753303,0.3535534,0.3181896,0.2705981,0.2126075,0.1464466,0.07465783,0,0,0.1379497,0.2705981,0.3928475,0.5,0.5879378,0.6532815,0.6935199,0.7071068,0.6935199,0.6532815,0.5879378,0.5,0.3928475,0.2705981,0.1379497,0,0,0.18024,0.3535534,0.51328,0.6532815,0.7681778,0.8535534,0.9061274,0.9238795,0.9061274,0.8535534,0.7681778,0.6532815,0.51328,0.3535534,0.18024,0,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,0.9807853,0.9238795,0.8314696,0.7071068,0.5555702,0.3826834,0.1950903,0,0,0.18024,0.3535534,0.51328,0.6532815,0.7681778,0.8535534,0.9061274,0.9238795,0.9061274,0.8535534,0.7681778,0.6532815,0.51328,0.3535534,0.18024,0,0,0.1379497,0.2705981,0.3928475,0.5,0.5879378,0.6532815,0.6935199,0.7071068,0.6935199,0.6532815,0.5879378,0.5,0.3928475,0.2705981,0.1379497,0,0,0.07465783,0.1464466,0.2126075,0.2705981,0.3181896,0.3535534,0.3753303,0.3826834,0.3753303,0.3535534,0.3181896,0.2705981,0.2126075,0.1464466,0.07465783,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-0,-0.07465783,-0.1464466,-0.2126075,-0.2705981,-0.3181896,-0.3535534,-0.3753303,-0.3826834,-0.3753303,-0.3535534,-0.3181896,-0.2705981,-0.2126075,-0.1464466,-0.07465783,-0,-0,-0.1379497,-0.2705981,-0.3928475,-0.5,-0.5879378,-0.6532815,-0.6935199,-0.7071068,-0.6935199,-0.6532815,-0.5879378,-0.5,-0.3928475,-0.2705981,-0.1379497,-0,-0,-0.18024,-0.3535534,-0.51328,-0.6532815,-0.7681778,-0.8535534,-0.9061274,-0.9238795,-0.9061274,-0.8535534,-0.7681778,-0.6532815,-0.51328,-0.3535534,-0.18024,-0,-0,-0.1950903,-0.3826834,-0.5555702,-0.7071068,-0.8314696,-0.9238795,-0.9807853,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,-0,-0,-0.18024,-0.3535534,-0.51328,-0.6532815,-0.7681778,-0.8535534,-0.9061274,-0.9238795,-0.9061274,-0.8535534,-0.7681778,-0.6532815,-0.51328,-0.3535534,-0.18024,-0,-0,-0.1379497,-0.2705981,-0.3928475,-0.5,-0.5879378,-0.6532815,-0.6935199,-0.7071068,-0.6935199,-0.6532815,-0.5879378,-0.5,-0.3928475,-0.2705981,-0.1379497,-0,-0,-0.07465783,-0.1464466,-0.2126075,-0.2705981,-0.3181896,-0.3535534,-0.3753303,-0.3826834,-0.3753303,-0.3535534,-0.3181896,-0.2705981,-0.2126075,-0.1464466,-0.07465783,-0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1],[0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,0.9807853,0.9238795,0.8314696,0.7071068,0.5555702,0.3826834,0.1950903,0,0,0.18024,0.3535534,0.51328,0.6532815,0.7681778,0.8535534,0.9061274,0.9238795,0.9061274,0.8535534,0.7681778,0.6532815,0.51328,0.3535534,0.18024,0,0,0.1379497,0.2705981,0.3928475,0.5,0.5879378,0.6532815,0.6935199,0.7071068,0.6935199,0.6532815,0.5879378,0.5,0.3928475,0.2705981,0.1379497,0,0,0.07465783,0.1464466,0.2126075,0.2705981,0.3181896,0.3535534,0.3753303,0.3826834,0.3753303,0.3535534,0.3181896,0.2705981,0.2126075,0.1464466,0.07465783,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-0,-0.07465783,-0.1464466,-0.2126075,-0.2705981,-0.3181896,-0.3535534,-0.3753303,-0.3826834,-0.3753303,-0.3535534,-0.3181896,-0.2705981,-0.2126075,-0.1464466,-0.07465783,-0,-0,-0.1379497,-0.2705981,-0.3928475,-0.5,-0.5879378,-0.6532815,-0.6935199,-0.7071068,-0.6935199,-0.6532815,-0.5879378,-0.5,-0.3928475,-0.2705981,-0.1379497,-0,-0,-0.18024,-0.3535534,-0.51328,-0.6532815,-0.7681778,-0.8535534,-0.9061274,-0.9238795,-0.9061274,-0.8535534,-0.7681778,-0.6532815,-0.51328,-0.3535534,-0.18024,-0,-0,-0.1950903,-0.3826834,-0.5555702,-0.7071068,-0.8314696,-0.9238795,-0.9807853,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,-0,-0,-0.18024,-0.3535534,-0.51328,-0.6532815,-0.7681778,-0.8535534,-0.9061274,-0.9238795,-0.9061274,-0.8535534,-0.7681778,-0.6532815,-0.51328,-0.3535534,-0.18024,-0,-0,-0.1379497,-0.2705981,-0.3928475,-0.5,-0.5879378,-0.6532815,-0.6935199,-0.7071068,-0.6935199,-0.6532815,-0.5879378,-0.5,-0.3928475,-0.2705981,-0.1379497,-0,-0,-0.07465783,-0.1464466,-0.2126075,-0.2705981,-0.3181896,-0.3535534,-0.3753303,-0.3826834,-0.3753303,-0.3535534,-0.3181896,-0.2705981,-0.2126075,-0.1464466,-0.07465783,-0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.07465783,0.1464466,0.2126075,0.2705981,0.3181896,0.3535534,0.3753303,0.3826834,0.3753303,0.3535534,0.3181896,0.2705981,0.2126075,0.1464466,0.07465783,0,0,0.1379497,0.2705981,0.3928475,0.5,0.5879378,0.6532815,0.6935199,0.7071068,0.6935199,0.6532815,0.5879378,0.5,0.3928475,0.2705981,0.1379497,0,0,0.18024,0.3535534,0.51328,0.6532815,0.7681778,0.8535534,0.9061274,0.9238795,0.9061274,0.8535534,0.7681778,0.6532815,0.51328,0.3535534,0.18024,0,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,0.9807853,0.9238795,0.8314696,0.7071068,0.5555702,0.3826834,0.1950903,0]],"it":[[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270],[17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288],[18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271]],"primitivetype":"triangle","material":null,"normals":null,"texcoords":[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1]]}});
unnamed_chunk_31rgl.prefix = "unnamed_chunk_31";
</script>

<p id="unnamed_chunk_31debug">
You must enable Javascript to view this page properly.</p>

<script>unnamed_chunk_31rgl.start();</script>

<p>You should be able to rotate (click and drag) and zoom (mouse wheel) this figure.</p>

<p>Since this results in quite large html files when used with many neurons,
we will not use it further here. For now let&#39;s show a plot in which we 
both select a subset of neurons and colour them according to their glomerulus
of origin.</p>

<pre><code class="r"># 3d plot of neurons from olfactory glomeruli beginning with a D
# coloured by glomerulus
rval=plot3d(Cell07PNs, subset=grepl(&quot;^D&quot;, Glomerulus), col=Glomerulus,
  lwd=2, WithNodes=FALSE)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-32"/></p>

<pre><code class="r"># make a legend so that you know which colours match which glomerulus
plot.new()
with(attr(rval,&#39;df&#39;), legend(&#39;center&#39;, legend = unique(Glomerulus), fill=unique(col)))
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANgAAADYCAMAAAC+/t3fAAAAZlBMVEUAAAAAADkAAGMAAP8AOYwAY7UA/wA5AAA5ADk5AGM5OYw5jNZjAABjADljOYxjY2Njtf+MOQCMOTmMOWOMjGOMtYyM1rWM1v+1YwC1///WjDnW////AAD/tWP/1oz//7X//9b///+CpEb5AAAACXBIWXMAAAsSAAALEgHS3X78AAACmklEQVR4nO3ZcW/SQBiA8c5Zp04dMJUJlvW+/5e0LS10y2WJ4W7H0zxPskj6x/n+UmivUIWFVpUeIFfCaAmjJYyWMFrCaAmjJYyWMFrCaAmjJYyWMFrCaAmjJYyWMFrCaAmjJYyWMFrCaAmjJYyWMFrCaAmjJYyWMFrCaAmjJYyWMFrCaAmjJex/103TBQOks2RYV1iuAXKtKyzXALnWFZZrgFzrCss1QK51heUa4K11L9kfXTfs79jsvzrc9dBV//L5+/Z46MufpNMVgvWK52+9rHm474801YfFwMLh6z60m98/9iE83fxazhkb3oUd7ml1PpRuupKwdrMNu/vQ1OdD6aYrfMbadXcRGT5dQFjkcn9UNB/3/ccsDO9FHizW6aq4Gy6MdVgMbLyPtY/TRWQhsHdYRViRdYXlGiDXulcNi97Hpt39dC1sKuAm+NNYbHc/wvp/dnXS6QrC+g3w7O4Vu5FBYd2NeaZZ0Bnrdvcn2OHuZpt0uus5Y9N3BImmKwnrd/ezD9bxgTPVdAUfW2ZXxY7IO2Oxzvex4UUddlWF+4wVWkVYkXWF5Rog17pXDVvujxK3Y9HHluHF8O09bxMcg724QQ+35uivEkzY6bGlXa/GXyXazc/u/DXjOcTCpk3w4fN2PNau6+7dWZ/ellBY/9hy/gVwgG22w9+0b4TCXj628GBv/igBhsV6/dgyHePDXn/9FhYCe4dVhBVZV1iuAXKtKyzXALnWFZZrgMi6abpggHSW60oYLWG0hNESRksYLWG0hNESRksYLWG0hNESRksYLWG0hNESRksYLWG0hNESRksYLWG0hNESRksYLWG0hNESRksYLWG0hNESRksYLWG0hNESRksYLWG0hNESRksYLWG0Fgv7B7mfLYiUC1TsAAAAAElFTkSuQmCC" alt="plot of chunk plot3d-legend"/></p>

<h2>Putting it all together</h2>

<p>To close this tutorial, let&#39;s do some morphological analysis of the neurons in 
this dataset. There are second order olfactory projection neurons 
originating from 4 different glomeruli in the <code>Cell07PNs</code> sample dataset, each 
coming from a different animal. We can
ask whether their axon terminal arborisations in a brain area called the lateral
horn show any features that are distinctive for different classes. This would be 
consistent with the hypothesis that information from different glomeruli 
(i.e. olfactory channels) is handled in a stereotyped way in this brain area.</p>

<p>Let&#39;s start by cutting out the arbour within the lateral horn from all of the
neurons. We&#39;ll use a very simple approach of cutting at X=250, although <strong>nat</strong>
has more sophisticated ways to do this e.g. by using 3D spaces defined by a 
surface mesh.</p>

<pre><code class="r"># note that we had to use OmitFailures=T due to a problem with the graph
# structure of one neuron
lha=nlapply(Cell07PNs, subset, X&gt;250, OmitFailures = T)
# Let&#39;s plot what we have colouring by glomerulus
plot(lha, col=Glomerulus, WithNodes=F)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-33"/></p>

<p>Now we can get a basic statistical summary by axon arbour.</p>

<pre><code class="r">lhstats=summary(lha, include.attached.dataframe = TRUE)
boxplot(lhstats$cable.length~lhstats$Glomerulus, log=&#39;y&#39;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-34"/></p>

<pre><code class="r">boxplot(lhstats$branchpoints~lhstats$Glomerulus)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-34"/></p>

<p>We can also calculate the median position of the arbour for each neuron and add
that to the lhstats database</p>

<pre><code class="r"># quick function to calculate centroid
arbour_centroid &lt;- function(n) {
  # extract location of all points in neuron object
  xyzs=xyzmatrix(n)
  # median in all 3 axes (=&gt;2 columns)
  apply(xyzs, 2, median)
}
# note that we have to transpose because sapply results in x,y,z rows
centroids=t(sapply(lha, arbour_centroid))
lhstats=cbind(lhstats, centroids)
</code></pre>

<p>Finally we can take these data and see how well we can predict the identity of
the neuron (i.e. its glomerulus) based on the statistics of the axon arbour in 
the lateral horn. We use the linear discriminant analysis (provided by the 
function <code>lda</code> in recommended package <code>MASS</code>). This also runs a leave one out
cross-validation to get a more robust initial estimate of prediction error.</p>

<pre><code class="r">library(MASS)
lda.fit = lda(Glomerulus ~ cable.length+X+Y+Z+branchpoints, lhstats, CV = T)
table(lda.fit$class, lhstats$Glomerulus)
</code></pre>

<pre><code>##       
##        DA1 DL3 DP1m VA1d
##   DA1   10   2    0    1
##   DL3    0   7    0    0
##   DP1m   0   0    8    0
##   VA1d   1   0    0   10
</code></pre>

<p>The prediction accuracy of 35/39 i.e. just under 90% is already very good compared
with a chance level of about 25% for these 4 classes.</p>

<h2>Learning More</h2>

<p>We hope this tutorial will provide you with a good foundation for further use of
the <strong>nat</strong> and related packages. Please visit the main 
<a href="http://jefferis.github.io/nat/index.html">nat README</a> for
suggestions of resources to learn more and solve problems. You may also
find that some time spent reading Hadley Wickham&#39;s <a href="http://adv-r.had.co.nz/">Advanced R</a> 
is a worthwhile investment. I recommend the first 7 chapters 
(Introduction to OO field guide) as material that will be helpful for anyone who
intends to carry out a significant project using R.</p>

</body>

</html>
